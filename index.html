<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PharmExpiry ‚Äî Gestion des p√©remptions</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2d6a4f">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="PharmExpiry">
<link rel="apple-touch-icon" href="icon-192.png">
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #f0ede8;
    --surface: #faf9f7;
    --border: #d8d3ca;
    --text: #1a1916;
    --muted: #7a756c;
    --accent: #2d6a4f;
    --accent-light: #d8ead2;
    --warn: #b5541a;
    --warn-light: #fdebd8;
    --danger: #8b1a1a;
    --danger-light: #fde8e8;
    --ok: #2d6a4f;
    --ok-light: #d8ead2;
    --ink: #1a1916;
    --radius: 12px;
    --reserve: #2d6a4f;
    --reserve-light: #d8ead2;
    --vss: #1a6b8a;
    --vss-light: #d0eaf5;
    --stups: #8f3a3a;
    --stups-light: #f7dfdf;
    --malledc: #7a5a1a;
    --malledc-light: #f7f0dd;
    --vaccin: #1a6b7a;
    --vaccin-light: #d8f0f4;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    padding: 24px;
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    margin-bottom: 28px;
    padding-bottom: 20px;
    border-bottom: 1.5px solid var(--border);
  }

  .logo h1 { font-family: 'DM Serif Display', serif; font-size: 2.2rem; letter-spacing: -0.5px; }
  .logo span { color: var(--accent); }
  .logo p { font-size: 0.8rem; color: var(--muted); font-family: 'DM Mono', monospace; letter-spacing: 0.05em; text-transform: uppercase; margin-top: 2px; }

  .stats-bar { display: flex; gap: 20px; align-items: flex-end; flex-direction: column; }

  .stats-row { display: flex; gap: 20px; }

  .stat { text-align: right; }
  .stat .n { font-family: 'DM Serif Display', serif; font-size: 1.8rem; line-height: 1; }
  .stat .l { font-size: 0.7rem; color: var(--muted); text-transform: uppercase; letter-spacing: 0.08em; font-family: 'DM Mono', monospace; }
  .stat.warn .n { color: var(--warn); }
  .stat.danger .n { color: var(--danger); }

  /* ‚îÄ‚îÄ LIEUX BADGES ‚îÄ‚îÄ */
  .lieu-badge {
    display: inline-flex;
    align-items: center;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.72rem;
    font-family: 'DM Mono', monospace;
    font-weight: 600;
    letter-spacing: 0.04em;
    white-space: nowrap;
  }

  .lieu-Reserve  { background: var(--reserve-light); color: var(--reserve); }
  .lieu-VSS      { background: var(--vss-light); color: var(--vss); }
  .lieu-Stups    { background: var(--stups-light); color: var(--stups); }
  .lieu-MalleDC  { background: var(--malledc-light); color: var(--malledc); }
  .lieu-Vaccin   { background: var(--vaccin-light); color: var(--vaccin); }

  /* ‚îÄ‚îÄ ENCART AJOUT ‚îÄ‚îÄ */
  .add-card {
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 28px;
  }

  .add-card h2 { font-family: 'DM Serif Display', serif; font-size: 1.15rem; margin-bottom: 16px; }

  .voice-unsupported-msg {
    font-size: 0.82rem; color: var(--warn);
    font-family: 'DM Mono', monospace;
    background: var(--warn-light); border: 1px solid var(--warn);
    border-radius: 8px; padding: 8px 12px; margin-bottom: 12px;
  }

  .voice-btn {
    width: 64px; height: 64px; border-radius: 50%; border: none;
    background: var(--accent); color: white; font-size: 1.5rem;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.2s; flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(45,106,79,0.3);
  }
  .voice-btn:hover { transform: scale(1.05); }
  .voice-btn.recording { background: var(--danger); animation: pulse 1s infinite; }
  .voice-btn:disabled { opacity: 0.35; cursor: not-allowed; transform: none; }

  .chain-btn {
    width: 64px; height: 64px; border-radius: 50%;
    border: 2px solid var(--border); background: var(--surface);
    color: var(--muted); font-size: 1.4rem;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.2s; flex-shrink: 0;
    font-family: 'DM Sans', sans-serif; font-weight: 600;
  }
  .chain-btn:hover { border-color: var(--warn); color: var(--warn); }
  .chain-btn.chain-active {
    background: var(--warn); border-color: var(--warn);
    color: white; animation: pulse-chain 1.5s infinite;
    box-shadow: 0 4px 16px rgba(181,84,26,0.4);
  }

  @keyframes pulse-chain {
    0%,100% { box-shadow: 0 4px 16px rgba(181,84,26,0.3); }
    50%      { box-shadow: 0 4px 28px rgba(181,84,26,0.6); }
  }

  @keyframes pulse {
    0%,100% { box-shadow: 0 4px 20px rgba(139,26,26,0.4); }
    50% { box-shadow: 0 4px 32px rgba(139,26,26,0.7); }
  }

  .voice-area { display: flex; gap: 16px; align-items: flex-start; }
  .voice-fields { flex: 1; display: flex; flex-direction: column; gap: 10px; }

  .transcript-box {
    background: var(--bg); border: 1.5px solid var(--border);
    border-radius: 8px; padding: 12px;
    font-family: 'DM Mono', monospace; font-size: 0.85rem;
    color: var(--muted); min-height: 48px; transition: border-color 0.2s;
  }
  .transcript-box.active { border-color: var(--accent); color: var(--text); }

  .fields-row {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr auto;
    gap: 10px; align-items: end;
  }

  label {
    display: block; font-size: 0.72rem; text-transform: uppercase;
    letter-spacing: 0.08em; font-family: 'DM Mono', monospace;
    color: var(--muted); margin-bottom: 5px;
  }

  input[type="text"], input[type="month"], input[type="date"], select {
    width: 100%; padding: 10px 12px;
    background: var(--bg); border: 1.5px solid var(--border);
    border-radius: 8px; font-family: 'DM Sans', sans-serif;
    font-size: 0.9rem; color: var(--text); outline: none;
    transition: border-color 0.2s; -webkit-appearance: none; appearance: none;
  }

  select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%237a756c'/%3E%3C/svg%3E");
    background-repeat: no-repeat; background-position: right 10px center;
    padding-right: 28px;
  }

  input:focus, select:focus { border-color: var(--accent); }

  .btn {
    padding: 10px 20px; border: none; border-radius: 8px;
    font-family: 'DM Sans', sans-serif; font-size: 0.9rem;
    font-weight: 600; cursor: pointer; transition: all 0.15s; white-space: nowrap;
  }
  .btn-primary { background: var(--accent); color: white; }
  .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); }

  .voice-hint { font-size: 0.78rem; color: var(--muted); font-style: italic; }

  /* ‚îÄ‚îÄ ONGLETS PRINCIPAUX ‚îÄ‚îÄ */
  .tabs {
    display: flex; gap: 0; margin-bottom: 24px;
    border-bottom: 2px solid var(--border);
  }

  .tab {
    padding: 10px 24px; border: none; background: transparent;
    font-family: 'DM Sans', sans-serif; font-size: 0.9rem;
    font-weight: 500; color: var(--muted); cursor: pointer;
    transition: all 0.2s; border-bottom: 2.5px solid transparent;
    margin-bottom: -2px; display: flex; align-items: center; gap: 7px;
  }
  .tab.active { color: var(--accent); border-bottom-color: var(--accent); font-weight: 600; }
  .tab:not(.active):hover { color: var(--text); }

  .tab-badge {
    font-size: 0.68rem; font-family: 'DM Mono', monospace;
    background: var(--border); color: var(--muted);
    padding: 1px 7px; border-radius: 20px;
  }
  .tab.active .tab-badge { background: var(--accent-light); color: var(--accent); }

  /* ‚îÄ‚îÄ SECTIONS ‚îÄ‚îÄ */
  .section { display: none; }
  .section.active { display: block; }

  /* ‚îÄ‚îÄ ONGLETS LIEUX (sous-navigation) ‚îÄ‚îÄ */
  .lieu-tabs {
    display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap;
  }

  .lieu-tab {
    padding: 8px 20px; border-radius: 8px;
    border: 1.5px solid var(--border);
    background: var(--surface);
    font-family: 'DM Sans', sans-serif; font-size: 0.85rem;
    font-weight: 500; color: var(--muted); cursor: pointer;
    transition: all 0.2s; display: flex; align-items: center; gap: 8px;
  }
  .lieu-tab:hover { border-color: var(--text); color: var(--text); }
  .lieu-tab.active-Reserve { background: var(--reserve); border-color: var(--reserve); color: white; }
  .lieu-tab.active-VSS     { background: var(--vss);     border-color: var(--vss);     color: white; }
  .lieu-tab.active-Stups   { background: var(--stups); border-color: var(--stups); color: white; }
  .lieu-tab.active-MalleDC { background: var(--malledc); border-color: var(--malledc); color: white; }
  .lieu-tab.active-Vaccin  { background: var(--vaccin); border-color: var(--vaccin); color: white; }
  .lieu-tab.active-all     { background: var(--ink); border-color: var(--ink); color: white; }

  .lieu-tab .count {
    font-size: 0.7rem; font-family: 'DM Mono', monospace;
    background: rgba(255,255,255,0.25); padding: 1px 6px; border-radius: 10px;
  }
  .lieu-tab:not([class*="active"]) .count {
    background: var(--bg); color: var(--muted);
  }

  /* ‚îÄ‚îÄ STOCK TABLE ‚îÄ‚îÄ */
  .stock-controls {
    display: flex; gap: 10px; margin-bottom: 16px;
    align-items: center; flex-wrap: wrap;
  }

  .search-input { flex: 1; min-width: 180px; }

  .sort-select {
    padding: 10px 32px 10px 12px; border: 1.5px solid var(--border);
    border-radius: 8px; font-family: 'DM Sans', sans-serif;
    font-size: 0.85rem; background: var(--surface); color: var(--muted);
    outline: none; cursor: pointer; -webkit-appearance: none; appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%237a756c'/%3E%3C/svg%3E");
    background-repeat: no-repeat; background-position: right 10px center;
    width: auto;
  }

  .stock-filters { display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap; }

  .filter-pill {
    padding: 5px 14px; border-radius: 20px; border: 1.5px solid var(--border);
    background: transparent; font-size: 0.78rem; cursor: pointer;
    font-family: 'DM Sans', sans-serif; transition: all 0.15s; color: var(--muted);
  }
  .filter-pill.active      { background: var(--ink); border-color: var(--ink); color: white; }
  .filter-pill.f-expired.active { background: var(--danger); border-color: var(--danger); }
  .filter-pill.f-soon.active    { background: var(--warn); border-color: var(--warn); }
  .filter-pill.f-ok.active      { background: var(--ok); border-color: var(--ok); }

  /* R√©sum√© global */
  .global-summary {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 20px;
  }

  .summary-card {
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: var(--radius);
    padding: 14px 16px;
  }

  .summary-card-title {
    font-size: 0.7rem; font-family: 'DM Mono', monospace;
    text-transform: uppercase; letter-spacing: 0.06em;
    margin-bottom: 10px; display: flex; align-items: center; gap: 6px;
  }

  .summary-card-title .dot {
    width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0;
  }
  .dot-Reserve { background: var(--reserve); }
  .dot-VSS     { background: var(--vss); }
  .dot-Stups   { background: var(--stups); }
  .dot-MalleDC { background: var(--malledc); }
  .dot-Vaccin  { background: var(--vaccin); }

  .summary-card-stats {
    display: flex; gap: 10px; flex-wrap: wrap;
  }

  .mini-stat { text-align: center; }
  .mini-stat .n { font-family: 'DM Serif Display', serif; font-size: 1.3rem; line-height: 1; }
  .mini-stat .l { font-size: 0.62rem; font-family: 'DM Mono', monospace; color: var(--muted); text-transform: uppercase; }
  .mini-stat.danger .n { color: var(--danger); }
  .mini-stat.warn .n { color: var(--warn); }

  .stock-table-wrap {
    background: var(--surface); border: 1.5px solid var(--border);
    border-radius: var(--radius); overflow: hidden;
  }

  .stock-table-header {
    padding: 14px 20px; border-bottom: 1.5px solid var(--border);
    display: flex; align-items: center; justify-content: space-between;
    background: var(--bg);
  }
  .stock-table-header span { font-family: 'DM Mono', monospace; font-size: 0.75rem; color: var(--muted); text-transform: uppercase; letter-spacing: 0.05em; }

  table { width: 100%; border-collapse: collapse; }
  thead th {
    text-align: left; padding: 10px 20px;
    font-size: 0.68rem; font-family: 'DM Mono', monospace;
    text-transform: uppercase; letter-spacing: 0.08em;
    color: var(--muted); border-bottom: 1px solid var(--border); background: var(--bg);
  }
  tbody td { padding: 12px 20px; font-size: 0.88rem; border-bottom: 1px solid var(--border); vertical-align: middle; }
  tbody tr:last-child td { border-bottom: none; }
  tbody tr:hover td { background: #f5f3ef; }
  .td-name { font-weight: 600; }
  .td-date { font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--muted); white-space: nowrap; }
  .td-actions { width: 80px; text-align: right; display: flex; gap: 6px; justify-content: flex-end; }

  /* ‚îÄ‚îÄ BOUTONS ACTION TABLE ‚îÄ‚îÄ */

  .med-del {
    width: 28px; height: 28px; border-radius: 6px;
    border: 1.5px solid transparent; background: transparent;
    cursor: pointer; color: var(--muted); font-size: 0.85rem;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.15s; flex-shrink: 0;
  }
  .med-del:hover { border-color: var(--danger); color: var(--danger); background: var(--danger-light); }


  /* ‚îÄ‚îÄ VUE PAR MOIS ‚îÄ‚îÄ */
  .month-picker-bar {
    background: var(--surface); border: 1.5px solid var(--border);
    border-radius: var(--radius); padding: 18px 20px;
    margin-bottom: 20px; display: flex;
    align-items: center; gap: 14px; flex-wrap: wrap;
  }

  .month-nav-group { display: flex; align-items: center; gap: 8px; flex: 1; }

  .nav-btn {
    width: 34px; height: 34px; border-radius: 50%;
    border: 1.5px solid var(--border); background: var(--bg);
    cursor: pointer; font-size: 1rem;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.15s; color: var(--text); flex-shrink: 0;
  }
  .nav-btn:hover { border-color: var(--accent); color: var(--accent); }

  .month-label-display {
    font-family: 'DM Serif Display', serif; font-size: 1.3rem;
    text-transform: capitalize; flex: 1; text-align: center;
  }

  .btn-today {
    padding: 6px 14px; border-radius: 20px;
    border: 1.5px solid var(--border); background: var(--bg);
    font-size: 0.75rem; font-family: 'DM Mono', monospace;
    cursor: pointer; transition: all 0.15s; color: var(--muted);
    text-transform: uppercase; letter-spacing: 0.06em; white-space: nowrap;
  }
  .btn-today:hover { border-color: var(--accent); color: var(--accent); }

  .month-actions {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 16px; flex-wrap: wrap; gap: 10px;
  }

  .month-summary { display: flex; gap: 8px; flex-wrap: wrap; }

  .summary-chip {
    padding: 5px 12px; border-radius: 20px;
    font-size: 0.78rem; font-family: 'DM Mono', monospace;
    display: flex; align-items: center; gap: 5px;
  }
  .chip-expired { background: var(--danger-light); color: var(--danger); }
  .chip-soon    { background: var(--warn-light); color: var(--warn); }
  .chip-ok      { background: var(--ok-light); color: var(--ok); }

  .btn-export {
    display: flex; align-items: center; gap: 8px; padding: 9px 18px;
    border: 1.5px solid var(--accent); border-radius: 8px;
    background: var(--accent-light); color: var(--accent);
    font-family: 'DM Sans', sans-serif; font-size: 0.85rem;
    font-weight: 600; cursor: pointer; transition: all 0.15s; white-space: nowrap;
  }
  .btn-export:hover { background: var(--accent); color: white; }

  /* ‚îÄ‚îÄ LISTE MEDS (vue mois) ‚îÄ‚îÄ */
  .med-list { display: flex; flex-direction: column; gap: 8px; }

  .med-item {
    background: var(--surface); border: 1.5px solid var(--border);
    border-radius: var(--radius); padding: 14px 18px;
    display: flex; align-items: center; gap: 12px;
    transition: all 0.15s; animation: slideIn 0.25s ease;
  }
  @keyframes slideIn { from { opacity:0; transform:translateY(-6px); } to { opacity:1; transform:translateY(0); } }

  .med-item:hover { border-color: var(--accent); }
  .med-item.expired { border-color: var(--danger); background: var(--danger-light); }
  .med-item.soon    { border-color: var(--warn); background: var(--warn-light); }
  .med-item.ok      { border-left: 3px solid var(--ok); }

  .med-name { font-weight: 600; font-size: 0.95rem; flex: 1; }
  .med-date { font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--muted); white-space: nowrap; }

  .med-badge {
    font-family: 'DM Mono', monospace; font-size: 0.72rem;
    padding: 3px 10px; border-radius: 20px; font-weight: 500; white-space: nowrap;
  }
  .badge-ok      { background: var(--ok-light); color: var(--ok); }
  .badge-soon    { background: var(--warn-light); color: var(--warn); }
  .badge-expired { background: var(--danger-light); color: var(--danger); }

  .med-del-round {
    width: 30px; height: 30px; border-radius: 50%;
    border: 1.5px solid transparent; background: transparent;
    cursor: pointer; color: var(--muted); font-size: 1rem;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.15s; flex-shrink: 0;
  }
  .med-del-round:hover { border-color: var(--danger); color: var(--danger); background: var(--danger-light); }

  .empty-state {
    text-align: center; padding: 60px 20px; color: var(--muted);
    background: var(--surface); border: 1.5px solid var(--border);
    border-radius: var(--radius);
  }
  .empty-state .icon { font-size: 2.5rem; margin-bottom: 10px; opacity: 0.4; }
  .empty-state p { font-size: 0.88rem; }

  /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
  .toast {
    position: fixed; bottom: 24px; right: 24px;
    background: var(--ink); color: white; padding: 12px 20px;
    border-radius: 10px; font-size: 0.85rem;
    font-family: 'DM Mono', monospace;
    transform: translateY(100px); opacity: 0; transition: all 0.3s; z-index: 1000;
  }
  .toast.show { transform: translateY(0); opacity: 1; }
  .toast.success { background: var(--accent); }
  .toast.error   { background: var(--danger); }

  /* ‚îÄ‚îÄ PRINT ‚îÄ‚îÄ */
  .print-header { display: none; }
  .print-stats  { display: none; }

  @media print {
    body { background: white; padding: 0; }
    header, .add-card, .tabs, #section-stock, .month-picker-bar,
    .month-actions, .lieu-tabs, .toast, .med-del-round { display: none !important; }
    #section-month { display: block !important; }
    .print-header { display: block !important; margin-bottom: 24px; padding-bottom: 12px; border-bottom: 2px solid #1a1916; }
    .print-title { font-family: 'DM Serif Display', serif; font-size: 1.6rem; }
    .print-subtitle { font-size: 0.8rem; color: #7a756c; font-family: monospace; text-transform: uppercase; letter-spacing: 0.06em; margin-top: 4px; }
    .month-summary { margin-bottom: 16px; }
    .summary-chip { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    .lieu-badge   { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    .med-item { break-inside: avoid; border: 1px solid #d8d3ca !important; margin-bottom: 6px; padding: 10px 14px; }
    .med-item.expired { background: #fde8e8 !important; border-color: #8b1a1a !important; print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    .med-item.soon    { background: #fdebd8 !important; border-color: #b5541a !important; print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    .med-badge { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    .empty-state { border: 1px solid #d8d3ca; }
    @page { margin: 20mm 15mm; }
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 640px) {
    .stats-bar { display: none; }
    .fields-row { grid-template-columns: 1fr 1fr; }
    .fields-row > *:nth-child(3) { grid-column: 1 / -1; }
    .fields-row .btn { grid-column: 1 / -1; }
    body { padding: 12px; }
    .global-summary { grid-template-columns: 1fr; }
    .month-picker-bar { flex-direction: column; align-items: stretch; }
    .month-nav-group { justify-content: center; }

    /* Masquer le tableau sur mobile */
    .stock-table-wrap table { display: none; }

    /* Cartes mobiles */
    .stock-cards { display: flex; flex-direction: column; gap: 8px; padding: 12px; }

    .stock-card {
      background: var(--surface);
      border-radius: 10px;
      border: 1.5px solid var(--border);
      padding: 12px 14px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .stock-card.expired { border-color: var(--danger); background: var(--danger-light); }
    .stock-card.soon    { border-color: var(--warn);   background: var(--warn-light); }

    .stock-card-top {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .stock-card-name {
      font-weight: 700;
      font-size: 0.95rem;
      flex: 1;
    }
    .stock-card-bottom {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .stock-card-date {
      font-family: 'DM Mono', monospace;
      font-size: 0.78rem;
      color: var(--muted);
      flex: 1;
    }
    .stock-card-actions {
      display: flex;
      gap: 6px;
      align-items: center;
      margin-left: auto;
    }
    .tab { padding: 10px 14px; font-size: 0.82rem; }
  }

  /* Sur desktop, masquer les cartes mobiles */
  @media (min-width: 641px) {
    .stock-cards { display: none; }
  }

  /* ‚îÄ‚îÄ EXPORT / IMPORT ‚îÄ‚îÄ */
  .backup-bar {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    align-items: center;
  }

  .backup-bar-label {
    font-size: 0.72rem;
    font-family: 'DM Mono', monospace;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--muted);
    margin-right: 4px;
  }

  .btn-backup {
    display: flex; align-items: center; gap: 6px;
    padding: 7px 14px; border-radius: 8px;
    font-family: 'DM Sans', sans-serif; font-size: 0.82rem; font-weight: 600;
    cursor: pointer; transition: all 0.15s; white-space: nowrap;
  }

  .btn-export-json {
    border: 1.5px solid var(--accent);
    background: var(--accent-light); color: var(--accent);
  }
  .btn-export-json:hover { background: var(--accent); color: white; }

  .btn-import-json {
    border: 1.5px solid var(--border);
    background: var(--surface); color: var(--muted);
  }
  .btn-import-json:hover { border-color: var(--text); color: var(--text); }

  .btn-detect-dupes {
    border: 1.5px solid var(--warn);
    background: var(--warn-light); color: var(--warn);
  }
  .btn-detect-dupes:hover { background: var(--warn); color: white; }

  /* ‚îÄ‚îÄ MODAL G√âN√âRIQUE ‚îÄ‚îÄ */
  .modal-overlay {
    position: fixed; inset: 0;
    background: rgba(26,25,22,0.5);
    display: flex; align-items: center; justify-content: center;
    z-index: 500; padding: 20px;
    opacity: 0; pointer-events: none; transition: opacity 0.2s;
  }
  .modal-overlay.open { opacity: 1; pointer-events: all; }
  .modal {
    background: var(--surface); border-radius: var(--radius);
    padding: 28px; width: 100%; max-width: 400px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.2);
    transform: translateY(16px); transition: transform 0.2s;
  }
  .modal-overlay.open .modal { transform: translateY(0); }
  .modal h3 { font-family: 'DM Serif Display', serif; font-size: 1.2rem; margin-bottom: 6px; }
  .modal .med-info { font-size: 0.82rem; color: var(--muted); font-family: 'DM Mono', monospace; margin-bottom: 4px; }
  .modal-fields { display: flex; flex-direction: column; gap: 14px; margin-bottom: 20px; }
  .modal-actions { display: flex; gap: 10px; justify-content: flex-end; }
  .btn-cancel {
    padding: 9px 18px; border: 1.5px solid var(--border);
    border-radius: 8px; background: transparent;
    font-family: 'DM Sans', sans-serif; font-size: 0.88rem;
    color: var(--muted); cursor: pointer; transition: all 0.15s;
  }
  .btn-cancel:hover { border-color: var(--text); color: var(--text); }

  .dupe-group {
    background: var(--warn-light); border: 1.5px solid var(--warn);
    border-radius: 10px; padding: 12px 14px;
  }
  .dupe-group-title {
    font-weight: 700; font-size: 0.88rem; margin-bottom: 8px;
    display: flex; align-items: center; gap: 6px;
  }
  .dupe-item {
    display: flex; align-items: center; justify-content: space-between;
    padding: 6px 0; border-top: 1px solid rgba(181,84,26,0.2);
    font-size: 0.83rem; gap: 8px;
  }
  .dupe-item:first-of-type { border-top: none; }
  .dupe-lieu { font-family: 'DM Mono', monospace; font-size: 0.72rem; color: var(--warn); }
  .dupe-date { font-family: 'DM Mono', monospace; font-size: 0.72rem; color: var(--muted); flex:1; }
</style>
</head>
<body>

<!-- ‚ïê‚ïê HEADER ‚ïê‚ïê -->
<header>
  <div class="logo">
    <h1>Pharm<span>Expiry</span></h1>
    <p>Gestion des dates de p√©remption</p>
  </div>
  <div class="stats-bar">
    <div class="stats-row">
      <div class="stat danger" id="stat-expired"><div class="n">0</div><div class="l">P√©rim√©s</div></div>
      <div class="stat warn"   id="stat-soon">   <div class="n">0</div><div class="l">Bient√¥t</div></div>
      <div class="stat"        id="stat-total">  <div class="n">0</div><div class="l">Total</div></div>
    </div>
  </div>
</header>

<!-- ‚ïê‚ïê BARRE SAUVEGARDE ‚ïê‚ïê -->
<div class="backup-bar">
  <span class="backup-bar-label">üíæ Sauvegarde</span>
  <button class="btn-backup btn-export-json" onclick="exportJSON()">‚¨á JSON</button>
  <button class="btn-backup btn-import-json" onclick="document.getElementById('importFile').click()">‚¨Ü JSON</button>
  <button class="btn-backup btn-detect-dupes" onclick="detectDuplicates()">üîç Doublons</button>
  <input type="file" id="importFile" accept=".json" style="display:none;" onchange="importJSON(event)">
</div>

<!-- ‚ïê‚ïê MODAL DOUBLONS ‚ïê‚ïê -->
<div class="modal-overlay" id="dupesOverlay" onclick="if(event.target===this) closeDupesModal()">
  <div class="modal" style="max-width:520px; max-height:80vh; display:flex; flex-direction:column;">
    <h3>üîç Doublons d√©tect√©s</h3>
    <div class="med-info" id="dupesInfo"></div>
    <div id="dupesList" style="overflow-y:auto; flex:1; margin: 16px 0; display:flex; flex-direction:column; gap:10px;"></div>
    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeDupesModal()">Fermer</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê ENCART AJOUT ‚ïê‚ïê -->
<div class="add-card">
  <h2>üé§ Ajouter un m√©dicament</h2>
  <div id="voiceUnsupportedMsg" class="voice-unsupported-msg" style="display:none;">
    üé§ La dict√©e vocale n'est pas disponible sur ce navigateur.
  </div>
  <div class="voice-area">
    <button class="voice-btn" id="voiceBtn" title="Dict√©e vocale">üé§</button>
    <button class="chain-btn" id="chainBtn" title="Mode cha√Æne ‚Äî dicte plusieurs m√©dicaments d'affil√©e">‚õì</button>
    <div class="voice-fields">
      <div class="transcript-box" id="transcript">Appuyez sur üé§ et dites par exemple : "Doliprane 1000 p√©remption mars 2026"</div>
      <div class="fields-row">
        <div>
          <label>M√©dicament</label>
          <input type="text" id="medName" placeholder="Nom du m√©dicament" autocomplete="off" list="medSuggestions">
          <datalist id="medSuggestions"></datalist>
        </div>
        <div>
          <label>Date de p√©remption</label>
          <input type="date" id="medDate">
        </div>
        <div>
          <label>Lieu</label>
          <select id="medLieu">
            <option value="Reserve">R√©serve/SDS/Bio</option>
            <option value="VSS">VSS</option>
            <option value="Stups">Stups</option>
            <option value="MalleDC">Malle DC</option>
            <option value="Vaccin">Vaccin</option>
          </select>
        </div>
        <button class="btn btn-primary" onclick="addMed()">+ Ajouter</button>
      </div>
      <p class="voice-hint" id="voiceHint">üí° Dites : "Doliprane 500 p√©remption janvier 2027"</p>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê ONGLETS PRINCIPAUX ‚ïê‚ïê -->
<div class="tabs">
  <button class="tab active" id="tab-stock" onclick="switchTab('stock')">
    üì¶ Stock total <span class="tab-badge" id="badge-stock">0</span>
  </button>
  <button class="tab" id="tab-month" onclick="switchTab('month')">
    üìÖ Par mois <span class="tab-badge" id="badge-month">‚Äî</span>
  </button>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ONGLET STOCK TOTAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="section active" id="section-stock">

  <!-- R√©sum√© global par lieu -->
  <div class="global-summary" id="globalSummary"></div>

  <!-- Contr√¥les -->
  <div class="stock-controls">
    <input class="search-input" type="text" id="searchStock" placeholder="üîç Rechercher dans le stock‚Ä¶" oninput="renderStock()">
    <select class="sort-select" id="sortStock" onchange="renderStock()">
      <option value="status">Urgence d'abord</option>
      <option value="date-asc">Date la plus proche</option>
      <option value="date-desc">Date la plus lointaine</option>
      <option value="name-asc">Nom A ‚Üí Z</option>
      <option value="name-desc">Nom Z ‚Üí A</option>
      <option value="lieu">Par lieu</option>
    </select>
  </div>

  <!-- Filtres statut -->
  <div class="stock-filters">
    <button class="filter-pill active"    onclick="setStockFilter('all', this)">Tout</button>
    <button class="filter-pill f-expired" onclick="setStockFilter('expired', this)">üî¥ P√©rim√©s</button>
    <button class="filter-pill f-soon"    onclick="setStockFilter('soon', this)">üü† Bient√¥t (‚â§30j)</button>
    <button class="filter-pill f-ok"      onclick="setStockFilter('ok', this)">üü¢ OK</button>
  </div>

  <!-- Filtre lieu -->
  <div class="lieu-tabs" id="lieuTabs">
    <button class="lieu-tab active-all" onclick="setLieuFilter('all', this)">
      Tous <span class="count" id="count-all">0</span>
    </button>
    <button class="lieu-tab" onclick="setLieuFilter('Reserve', this)">
      R√©serve/SDS/Bio <span class="count" id="count-Reserve">0</span>
    </button>
    <button class="lieu-tab" onclick="setLieuFilter('VSS', this)">
      VSS <span class="count" id="count-VSS">0</span>
    </button>
    <button class="lieu-tab" onclick="setLieuFilter('Stups', this)">
      Stups <span class="count" id="count-Stups">0</span>
    </button>
    <button class="lieu-tab" onclick="setLieuFilter('MalleDC', this)">
      Malle DC <span class="count" id="count-MalleDC">0</span>
    </button>
    <button class="lieu-tab" onclick="setLieuFilter('Vaccin', this)">
      Vaccin <span class="count" id="count-Vaccin">0</span>
    </button>
  </div>

  <!-- Tableau -->
  <div class="stock-table-wrap">
    <div class="stock-table-header">
      <span id="stockCountLabel">0 m√©dicament</span>
    </div>
    <table>
      <thead>
        <tr>
          <th>M√©dicament</th>
          <th>Lieu</th>
          <th>Date p√©remption</th>
          <th>Statut</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="stockBody"></tbody>
    </table>
    <div class="stock-cards" id="stockCards"></div>
    <div id="stockEmpty" class="empty-state" style="display:none;">
      <div class="icon">üì¶</div><p>Aucun m√©dicament dans le stock.</p>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ONGLET PAR MOIS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="section" id="section-month">

  <div class="print-header">
    <div class="print-title">Pharm<span style="color:#2d6a4f">Expiry</span> ‚Äî P√©remptions du mois</div>
    <div class="print-subtitle" id="printSubtitle"></div>
  </div>

  <div class="month-picker-bar">
    <label>Mois √† afficher</label>
    <div class="month-nav-group">
      <button class="nav-btn" onclick="changeMonth(-1)">‚Äπ</button>
      <div class="month-label-display" id="monthLabel"></div>
      <button class="nav-btn" onclick="changeMonth(1)">‚Ä∫</button>
    </div>
    <input style="padding:8px 12px;width:auto;font-size:0.85rem;" type="month" id="monthPicker" onchange="onMonthPick()">
    <button class="btn-today" onclick="goToToday()">Ce mois-ci</button>
  </div>

  <!-- Filtre lieu dans vue mois aussi -->
  <div class="lieu-tabs" id="lieuTabsMonth">
    <button class="lieu-tab active-all" onclick="setLieuFilterMonth('all', this)">Tous</button>
    <button class="lieu-tab" onclick="setLieuFilterMonth('Reserve', this)">R√©serve/SDS/Bio</button>
    <button class="lieu-tab" onclick="setLieuFilterMonth('VSS', this)">VSS</button>
    <button class="lieu-tab" onclick="setLieuFilterMonth('Stups', this)">Stups</button>
    <button class="lieu-tab" onclick="setLieuFilterMonth('MalleDC', this)">Malle DC</button>
    <button class="lieu-tab" onclick="setLieuFilterMonth('Vaccin', this)">Vaccin</button>
  </div>

  <div class="month-actions">
    <div class="month-summary" id="monthSummary"></div>
    <button class="btn-export" onclick="exportPDF()" id="btnExport" style="display:none;">‚¨á Exporter en PDF</button>
  </div>

  <div class="med-list" id="medList"></div>
</div>

<div class="toast" id="toast"></div>

<script>
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// STORAGE
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let meds = [];

function loadData() {
  try {
    // Essaie d'abord la cl√© actuelle
    let raw = localStorage.getItem('pharmExpiry_v2');

    // Migration depuis les anciennes cl√©s si rien trouv√©
    if (!raw) raw = localStorage.getItem('pharmExpiry');
    if (!raw) raw = localStorage.getItem('pharmExpiry_v1');

    if (raw) {
      meds = JSON.parse(raw);
      meds = meds.map(m => ({ lieu: 'Reserve', ...m }));
      localStorage.setItem('pharmExpiry_v2', JSON.stringify(meds));
    }
    if (!raw || meds.length === 0) {
      // Donn√©es int√©gr√©es par d√©faut
      meds = [{"lieu":"Reserve","qty":1,"id":"1772004711213","name":"Gants taille S","date":"2029-08-31"},{"lieu":"Reserve","qty":1,"id":"1772004754883","name":"Gants taille M","date":"2029-07-31"},{"lieu":"Reserve","qty":1,"id":"1772004794616","name":"Gants taille L","date":"2029-10-31"},{"lieu":"Reserve","qty":1,"id":"1772004822453","name":"Gants taille L","date":"2030-05-31"},{"lieu":"Reserve","qty":1,"id":"1772004855329","name":"Gants taille XL","date":"2029-10-31"},{"lieu":"Reserve","qty":1,"id":"1772004868594","name":"Gants Taille XL","date":"2028-11-30"},{"lieu":"Reserve","qty":1,"id":"1772004973208","name":"Masque chirurgical","date":"2027-01-01"},{"lieu":"Reserve","qty":1,"id":"1772005034619","name":"Pansement absorbant","date":"2030-01-01"},{"lieu":"Reserve","qty":1,"id":"1772005074085","name":"Lingettes d√©sinfectantes","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772005103058","name":"Lingettes d√©sinfectante","date":"2028-04-14"},{"lieu":"Reserve","qty":1,"id":"1772005248884","name":"Doigti√©","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772005271420","name":"Doigti√©","date":"2026-09-30"},{"lieu":"Reserve","qty":1,"id":"1772005300816","name":"Doigti√©","date":"2028-05-31"},{"lieu":"Reserve","qty":1,"id":"1772005365748","name":"S√©rum physiologique 50 ml","date":"2028-04-30"},{"lieu":"Reserve","qty":1,"id":"1772005597806","name":"S√©rum physiologique 5ml","date":"2027-08-31"},{"lieu":"Reserve","qty":1,"id":"1772005643903","name":"S√©rum physiologique 5 ml","date":"2027-12-31"},{"lieu":"Reserve","qty":1,"id":"1772005708064","name":"Pansement Sylaplaie","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772005760113","name":"Optiskin","date":"2028-12-31"},{"lieu":"Reserve","qty":1,"id":"1772005778376","name":"Optiskin","date":"2029-10-31"},{"lieu":"Reserve","qty":1,"id":"1772005845656","name":"Pansement lecomed","date":"2028-02-29"},{"lieu":"Reserve","qty":1,"id":"1772005927870","name":"Bande de gaz","date":"2026-04-30"},{"lieu":"Reserve","qty":1,"id":"1772005987344","name":"Compeed","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772006043951","name":"Duoderme","date":"2027-02-28"},{"lieu":"Reserve","qty":1,"id":"1772006087401","name":"Duoderme","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772006145627","name":"MePilex border","date":"2028-02-29"},{"lieu":"Reserve","qty":1,"id":"1772006174667","name":"Pansement alevin","date":"2026-05-31"},{"lieu":"Reserve","qty":1,"id":"1772006208148","name":"Gel l'hydroalcoolique","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772006219939","name":"Gel hydroalcoolique","date":"2026-04-30"},{"lieu":"Reserve","qty":1,"id":"1772006251092","name":"Alcool modifi√©","date":"2026-03-31"},{"lieu":"Reserve","qty":1,"id":"1772006286935","name":"Savon doux","date":"2028-02-29"},{"lieu":"Reserve","qty":1,"id":"1772006301877","name":"Eau st√©rile","date":"2027-09-12"},{"lieu":"Reserve","qty":1,"id":"1772006352236","name":"Aquacell","date":"2030-05-31"},{"lieu":"Reserve","qty":1,"id":"1772006374827","name":"Aquacell","date":"2029-06-30"},{"lieu":"Reserve","qty":1,"id":"1772006408563","name":"Abaisse-langue","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772006431488","name":"Gel anti adh√©sif","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772006531290","name":"Jelonet 10 par","date":"2029-06-10"},{"lieu":"Reserve","qty":1,"id":"1772006562417","name":"Jelonet 10 par","date":"2028-01-10"},{"lieu":"Reserve","qty":1,"id":"1772006629249","name":"Jelonet 5 cm","date":"2028-04-30"},{"lieu":"Reserve","qty":1,"id":"1772006658004","name":"Jelonet 5 cm","date":"2029-04-30"},{"lieu":"Reserve","qty":1,"id":"1772006713937","name":"Compresses non st√©riles","date":"2029-03-31"},{"lieu":"Reserve","qty":1,"id":"1772006739875","name":"Compresse st√©rile","date":"2029-05-03"},{"lieu":"Reserve","qty":1,"id":"1772006835447","name":"S√©rum physiologique 5 ml","date":"2028-02-29"},{"lieu":"Reserve","qty":1,"id":"1772006905464","name":"S√©rum physiologique 50 ml","date":"2028-03-31"},{"lieu":"Reserve","qty":1,"id":"1772006976022","name":"Savon liquide 10 ml","date":"2027-12-31"},{"lieu":"Reserve","qty":1,"id":"1772007019345","name":"Eau oxyg√©n√©e","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772007047535","name":"B√©tadine","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772007123798","name":"ChloraPrep","date":"2026-10-31"},{"lieu":"Reserve","qty":1,"id":"1772007201460","name":"Dakin","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772007265423","name":"Bande cr√™pes quatre par 7 cm","date":"2027-09-30"},{"lieu":"Reserve","qty":1,"id":"1772007299541","name":"Bande cr√™pes quatre par 7cm","date":"2029-04-30"},{"lieu":"Reserve","qty":1,"id":"1772007357591","name":"Bande de cr√™pes quatre par 10 cm","date":"2028-03-31"},{"lieu":"Reserve","qty":1,"id":"1772007423512","name":"Bande de cr√™pes quatre par 7 cm","date":"2029-04-30"},{"lieu":"Reserve","qty":1,"id":"1772007436808","name":"Bande de cr√™pes quatre par 7 cm","date":"2029-11-30"},{"lieu":"Reserve","qty":1,"id":"1772007471287","name":"Bonne cr√™pe quatre par 10 cm","date":"2026-10-31"},{"lieu":"Reserve","qty":1,"id":"1772007494750","name":"Bande cr√™pe quatre par 10 cm","date":"2027-09-30"},{"lieu":"Reserve","qty":1,"id":"1772007578537","name":"Aiguilles intramusculaire","date":"2026-12-31"},{"lieu":"Reserve","qty":1,"id":"1772007678643","name":"Trocart","date":"2028-03-31"},{"lieu":"Reserve","qty":1,"id":"1772007708443","name":"Seringue 5 ml","date":"2026-09-30"},{"lieu":"Reserve","qty":1,"id":"1772007725104","name":"Seringue 5 ml","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772007750974","name":"Seringue 3 ml","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772007798010","name":"Seringue 10 ml","date":"2028-06-30"},{"lieu":"Reserve","qty":1,"id":"1772007867431","name":"Curette","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772007887709","name":"Test Covid","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772007941348","name":"B√¢ton ophtalmique","date":"2028-04-30"},{"lieu":"Reserve","qty":1,"id":"1772008030827","name":"Diclofenac gel","date":"2026-10-31"},{"lieu":"Reserve","qty":1,"id":"1772008082012","name":"B√©tadine gel","date":"2027-03-31"},{"lieu":"Reserve","qty":1,"id":"1772008093995","name":"B√©tadine gel","date":"2028-01-31"},{"lieu":"Reserve","qty":1,"id":"1772008105291","name":"B√©tadine gel","date":"2028-07-31"},{"lieu":"Reserve","qty":1,"id":"1772008200790","name":"Flammazine","date":"2026-11-30"},{"lieu":"Reserve","qty":1,"id":"1772008211014","name":"Flammazine","date":"2027-12-31"},{"lieu":"Reserve","qty":1,"id":"1772008271176","name":"Vaseline","date":"2029-07-31"},{"lieu":"Reserve","qty":1,"id":"1772008316187","name":"Seringue 20 ml","date":"2027-12-31"},{"lieu":"Reserve","qty":1,"id":"1772008328165","name":"Seringue 20 ml","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772008754950","name":"Colle tissulaire","date":"2026-03-31"},{"lieu":"Reserve","qty":1,"id":"1772008768009","name":"Colle tissulaire","date":"2026-08-31"},{"lieu":"Reserve","qty":1,"id":"1772008802540","name":"St√©rile strip","date":"2027-12-31"},{"lieu":"Reserve","qty":1,"id":"1772008837667","name":"St√©rile strip","date":"2029-06-30"},{"lieu":"Reserve","qty":1,"id":"1772008937249","name":"File de suture 20 taille","date":"2027-11-30"},{"lieu":"Reserve","qty":1,"id":"1772008951056","name":"Fil de suture 20 taille","date":"2027-09-30"},{"lieu":"Reserve","qty":1,"id":"1772009002697","name":"File de suture 30 taille","date":"2028-06-30"},{"lieu":"Reserve","qty":1,"id":"1772009042861","name":"Fil de suture 60 taille","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772009089160","name":"Ciseaux st√©riles","date":"2026-09-30"},{"lieu":"Reserve","qty":1,"id":"1772009099549","name":"Ciseaux st√©rile","date":"2028-05-31"},{"lieu":"Reserve","qty":1,"id":"1772009112745","name":"Ciseaux st√©riles","date":"2029-03-31"},{"lieu":"Reserve","qty":1,"id":"1772009158601","name":"Curette","date":"2027-11-30"},{"lieu":"Reserve","qty":1,"id":"1772009270696","name":"Bistouri","date":"2029-09-30"},{"lieu":"Reserve","qty":1,"id":"1772009296834","name":"Pince le riche","date":"2029-03-31"},{"lieu":"Reserve","qty":1,"id":"1772009344700","name":"Aiguille de pr√©l√®vement verte","date":"2029-02-28"},{"lieu":"Reserve","qty":1,"id":"1772009387098","name":"Pansement pour perfusion transparent","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772009445111","name":"Penthrox","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772009469448","name":"Chlorhexidine","date":"2026-11-30"},{"lieu":"Reserve","qty":1,"id":"1772009484539","name":"Chlorhexidine","date":"2027-02-28"},{"lieu":"Reserve","qty":1,"id":"1772009518029","name":"Aiguille de pr√©l√®vement type H√©lette","date":"2027-10-18"},{"lieu":"Reserve","qty":1,"id":"1772009552102","name":"Cyanokit","date":"2028-05-26"},{"lieu":"Reserve","qty":1,"id":"1772009605648","name":"Test angine","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772009816825","name":"Adaptateur prise de sang bleu","date":"2027-10-31"},{"lieu":"Reserve","qty":1,"id":"1772009882977","name":"Strap 6 cm par 2,5 m","date":"2027-03-31"},{"lieu":"Reserve","qty":1,"id":"1772009912658","name":"Strap 15 cm par 2,5 m","date":"2027-02-28"},{"lieu":"Reserve","qty":1,"id":"1772009934821","name":"Strap 15 cm par 2,5 m","date":"2026-03-31"},{"lieu":"Reserve","qty":1,"id":"1772010058955","name":"Strap 4 cm par 10 m","date":"2027-04-30"},{"lieu":"Reserve","qty":1,"id":"1772010162954","name":"Bande coh√©sive 7,5 cm par 4,5 m","date":"2028-06-30"},{"lieu":"Reserve","qty":1,"id":"1772015319703","name":"Mepilex 10 cm par 25 cm","date":"2028-01-31"},{"lieu":"Reserve","qty":1,"id":"1772015423744","name":"Bande coh√©sive 7,5 cm par 2 m","date":"2027-09-02"},{"lieu":"Reserve","qty":1,"id":"1772015464170","name":"Bande coh√©sif 7,5 cm par 2m","date":"2026-12-11"},{"lieu":"Reserve","qty":1,"id":"1772015526610","name":"Masque haute concentration adulte","date":"2026-04-30"},{"lieu":"Reserve","qty":1,"id":"1772015543270","name":"Masque haute concentration adulte","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772015592691","name":"Circuit MEOPA adulte","date":"2028-02-29"},{"lieu":"Reserve","qty":1,"id":"1772015607681","name":"Circuit MEOPA adulte","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772015648381","name":"Tuyau d'√©vacuation de gaz MEOPA","date":"2028-02-29"},{"lieu":"Reserve","qty":1,"id":"1772015686415","name":"Masque vert MEOPA","date":"2028-03-31"},{"lieu":"Reserve","qty":1,"id":"1772015722662","name":"Masque jaune MEOPA","date":"2028-07-31"},{"lieu":"Reserve","qty":1,"id":"1772015733805","name":"Masque jaune MEOPA","date":"2029-04-30"},{"lieu":"Reserve","qty":1,"id":"1772015797629","name":"Poche de froid","date":"2030-03-31"},{"lieu":"Reserve","qty":1,"id":"1772015810068","name":"Poche de froid","date":"2028-12-31"},{"lieu":"Reserve","qty":1,"id":"1772015862333","name":"Pince enl√®ve agrafes","date":"2027-04-30"},{"lieu":"Reserve","qty":1,"id":"1772015880811","name":"Pince enl√®ve agrafes","date":"2027-10-31"},{"lieu":"Reserve","qty":1,"id":"1772015898669","name":"Agrafeuse","date":"2027-11-28"},{"lieu":"Reserve","qty":1,"id":"1772015935973","name":"Set ablation de suture","date":"2029-10-15"},{"lieu":"Reserve","qty":1,"id":"1772015983631","name":"Kit de suture","date":"2026-08-31"},{"lieu":"Reserve","qty":1,"id":"1772015993454","name":"Kit de suture","date":"2027-04-30"},{"lieu":"Reserve","qty":1,"id":"1772016025177","name":"Gants st√©riles 6,5 taille","date":"2028-05-31"},{"lieu":"Reserve","qty":1,"id":"1772016059424","name":"Gants st√©riles 6,5 taille","date":"2026-07-28"},{"lieu":"Reserve","qty":1,"id":"1772016208221","name":"Kit pansement","date":"2030-02-28"},{"lieu":"Reserve","qty":1,"id":"1772016238746","name":"Kit de pansement","date":"2029-09-30"},{"lieu":"Reserve","qty":1,"id":"1772016249188","name":"Kit de pansement","date":"2028-08-31"},{"lieu":"Reserve","qty":1,"id":"1772016264644","name":"Kit de pansement","date":"2029-04-30"},{"lieu":"Reserve","qty":1,"id":"1772016330932","name":"Champ st√©rile 1er","date":"2026-04-30"},{"lieu":"Reserve","qty":1,"id":"1772016361053","name":"Cupule","date":"2029-02-28"},{"lieu":"Reserve","qty":1,"id":"1772016498552","name":"Racecadotril tiorfan 100 mg","date":"2027-01-31"},{"lieu":"Reserve","qty":1,"id":"1772016669121","name":"Floroglucinole Spasfon","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772016712230","name":"Floroglucinol Spasfon","date":"2026-08-31"},{"lieu":"Reserve","qty":1,"id":"1772016809083","name":"Metopilazine vogal√®ne","date":"2026-09-30"},{"lieu":"Reserve","qty":1,"id":"1772016864880","name":"PRIMPERAN","date":"2028-01-31"},{"lieu":"Reserve","qty":1,"id":"1772016917129","name":"GELOX","date":"2026-12-31"},{"lieu":"Reserve","qty":1,"id":"1772016969549","name":"RIVOTRIL","date":"2027-10-31"},{"lieu":"Reserve","qty":1,"id":"1772016998384","name":"DIAZEPAM","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772017054460","name":"LOXAPAC","date":"2027-10-31"},{"lieu":"Reserve","qty":1,"id":"1772017084021","name":"SPASFON injectables","date":"2026-04-30"},{"lieu":"Reserve","qty":1,"id":"1772017120988","name":"PANOTILE","date":"2026-09-30"},{"lieu":"Reserve","qty":1,"id":"1772017146895","name":"CERULYSE","date":"2026-10-31"},{"lieu":"Reserve","qty":1,"id":"1772017188221","name":"FLUORESCEINE","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772017283655","name":"DACRYOSERUM","date":"2027-01-31"},{"lieu":"Reserve","qty":1,"id":"1772017296148","name":"DACRYOSERUM","date":"2027-03-31"},{"lieu":"Reserve","qty":1,"id":"1772017326480","name":"CEF TRIAXONE","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772017373148","name":"KETOPROFENE 100 mg","date":"2027-02-28"},{"lieu":"Reserve","qty":1,"id":"1772017412079","name":"KETOPROFENE injectables","date":"2027-08-31"},{"lieu":"Reserve","qty":1,"id":"1772017450888","name":"CORTANCYL","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772017470303","name":"FLUMAZENIL","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772017550782","name":"POLARAMINE","date":"2026-12-31"},{"lieu":"Reserve","qty":1,"id":"1772018090401","name":"CETIRIZINE","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772018104602","name":"CETIRIZINE","date":"2026-08-31"},{"lieu":"Reserve","qty":1,"id":"1772021423033","name":"M√®che nasale","date":"2026-04-08"},{"lieu":"Reserve","qty":1,"id":"1772023700168","name":"Amoxicilline 500 mg","date":"2026-09-30"},{"lieu":"Reserve","qty":1,"id":"1772023936895","name":"Augmentin","date":"2026-03-31"},{"lieu":"Reserve","qty":1,"id":"1772023968148","name":"RIFAMPICINE","date":"2027-11-30"},{"lieu":"Reserve","qty":1,"id":"1772024004317","name":"CIPROFLOXACINE","date":"2026-04-30"},{"lieu":"Reserve","qty":1,"id":"1772024034833","name":"Pommade de vitamines A","date":"2028-02-27"},{"lieu":"Reserve","qty":1,"id":"1772024068381","name":"Doliprane","date":"2027-12-31"},{"lieu":"Reserve","qty":1,"id":"1772024136461","name":"Ketoprofene 100 mg","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772024262701","name":"SALBUTAMOL 5 mg","date":"2027-05-31"},{"lieu":"Reserve","qty":1,"id":"1772024285130","name":"TERBUTALINE 5 mg","date":"2026-07-31"},{"lieu":"Reserve","qty":1,"id":"1772024337659","name":"IPRATROPUIM 0,5 mg","date":"2026-05-31"},{"lieu":"Reserve","qty":1,"id":"1772024359386","name":"Ventoline","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772024422326","name":"LIDOCAINE","date":"2026-04-30"},{"lieu":"Reserve","qty":1,"id":"1772024471427","name":"LOVENOX 4000 UI","date":"2027-01-31"},{"lieu":"Reserve","qty":1,"id":"1772024971144","name":"G 30 %","date":"2026-09-30"},{"lieu":"Reserve","qty":1,"id":"1772024991803","name":"√âconazole poudre","date":"2027-07-31"},{"lieu":"Reserve","qty":1,"id":"1772025043103","name":"LIDOCAINE pulv√©risation buccale","date":"2027-06-30"},{"lieu":"Reserve","qty":1,"id":"1772028591746","name":"PANTOPRAZOLE 20 mg","date":"2027-03-31"},{"lieu":"Reserve","qty":1,"id":"1772028612855","name":"ASPEGIC 500 mg","date":"2026-06-30"},{"lieu":"Reserve","qty":1,"id":"1772028633650","name":"SMECTA","date":"2027-11-30"},{"lieu":"Reserve","qty":1,"id":"1772028653716","name":"NALOXONE","date":"2026-08-31"},{"lieu":"Reserve","qty":1,"id":"1772028680770","name":"PYOSTACINE","date":"2026-11-30"},{"lieu":"Reserve","qty":1,"id":"1772028702215","name":"ROVAMYCINE","date":"2026-05-31"},{"lieu":"Reserve","qty":1,"id":"1772028722832","name":"Gants st√©rile 8,5 taille","date":"2026-04-28"},{"lieu":"Reserve","qty":1,"id":"1772028754524","name":"ASPEGIC injectables","date":"2027-08-31"},{"lieu":"Reserve","qty":1,"id":"1772028842341","name":"MEPILEX 10 cm par 10cm","date":"2028-01-28"},{"lieu":"Reserve","qty":1,"id":"1772028905455","name":"Aiguille de pr√©l√®vement √† ailettes","date":"2027-07-13"},{"lieu":"Reserve","qty":1,"id":"1772028938276","name":"Compresse non st√©riles","date":"2029-03-29"},{"lieu":"Vaccin","qty":1,"id":"1772029340536","name":"VAQTA","date":"2026-12-31"},{"lieu":"Vaccin","qty":1,"id":"1772029351461","name":"REPEVAX","date":"2028-01-31"},{"lieu":"Vaccin","qty":1,"id":"1772029364172","name":"NIMENRIX","date":"2028-02-29"},{"lieu":"Vaccin","qty":1,"id":"1772029376980","name":"NIMENRIX","date":"2028-04-30"},{"lieu":"Vaccin","qty":1,"id":"1772029387418","name":"VAXIGRIP","date":"2026-05-31"},{"lieu":"Vaccin","qty":1,"id":"1772029400234","name":"VARILIX","date":"2026-12-31"},{"lieu":"Vaccin","qty":1,"id":"1772029413375","name":"TYPHIM","date":"2026-10-31"},{"lieu":"Vaccin","qty":1,"id":"1772029424852","name":"TICOVAC","date":"2026-09-30"},{"lieu":"Vaccin","qty":1,"id":"1772029439825","name":"MMRVAX pro","date":"2026-10-31"},{"lieu":"Vaccin","qty":1,"id":"1772029518852","name":"ENGERIXB","date":"2027-04-30"},{"lieu":"Vaccin","qty":1,"id":"1772029532848","name":"MMRVAX pro","date":"2026-04-30"},{"lieu":"Vaccin","qty":1,"id":"1772029550929","name":"QUANTIFERON","date":"2026-06-30"},{"lieu":"Vaccin","qty":1,"id":"1772029566274","name":"QUANTIFERON","date":"2026-08-31"},{"lieu":"Vaccin","qty":1,"id":"1772029580018","name":"QUANTIFERON","date":"2026-07-31"},{"lieu":"Vaccin","qty":1,"id":"1772029729116","name":"Covid","date":"2026-04-14"},{"lieu":"Vaccin","qty":1,"id":"1772029788704","name":"Calcitonine","date":"2026-04-30"},{"lieu":"Reserve","id":"1772033193388","name":"Lames de tondeuse","date":"2029-05-01","qty":1},{"lieu":"Reserve","id":"1772033219372","name":"Circuit d'√©vacuation MEOPA","date":"2027-09-30","qty":1},{"lieu":"Reserve","id":"1772033237235","name":"BAVU","date":"2026-08-13","qty":1},{"lieu":"Reserve","id":"1772033290822","name":"Masque pour n√©bulisation p√©diatrique","date":"2027-04-30","qty":1},{"lieu":"Reserve","id":"1772033321449","name":"Masque pour n√©bulisation adulte","date":"2028-01-06","qty":1},{"lieu":"Reserve","id":"1772033344857","name":"MEOPA","date":"2027-03-31","qty":1},{"lieu":"Reserve","id":"1772033361224","name":"Oxyg√®ne","date":"2030-03-31","qty":1},{"lieu":"Reserve","id":"1772033377226","name":"Oxyg√®ne","date":"2023-12-31","qty":1},{"lieu":"Reserve","id":"1772033449776","name":"Tubes jaune","date":"2026-10-31","qty":1},{"lieu":"Reserve","id":"1772033463442","name":"Tubes jaune","date":"2026-06-30","qty":1},{"lieu":"Reserve","id":"1772033473465","name":"Tubes jaune","date":"2026-11-30","qty":1},{"lieu":"Reserve","id":"1772033536153","name":"Tubes violet","date":"2026-05-31","qty":1},{"lieu":"Reserve","id":"1772034107497","name":"KT gris","date":"2027-04-30","qty":1},{"lieu":"Reserve","id":"1772034178552","name":"KT vert","date":"2029-07-31","qty":1},{"lieu":"Reserve","id":"1772034201899","name":"KT vert","date":"2029-05-31","qty":1},{"lieu":"Reserve","id":"1772034227849","name":"KT vers","date":"2029-12-31","qty":1},{"lieu":"Reserve","id":"1772034269691","name":"KT rose","date":"2029-02-28","qty":1},{"lieu":"Reserve","id":"1772034313620","name":"KT bleu","date":"2027-08-31","qty":1},{"lieu":"Reserve","id":"1772034323222","name":"KT bleu","date":"2029-01-31","qty":1},{"lieu":"Reserve","id":"1772034363279","name":"Robinet 3 voie","date":"2027-02-28","qty":1},{"lieu":"Reserve","id":"1772034377091","name":"Robinet trois voies","date":"2027-07-31","qty":1},{"lieu":"Reserve","id":"1772034419108","name":"Bouchons rouge","date":"2026-11-30","qty":1},{"lieu":"Reserve","id":"1772034428867","name":"Bouchons rouge","date":"2026-03-16","qty":1},{"lieu":"Reserve","id":"1772034498051","name":"Aiguille de pr√©l√®vement √† H√©lette","date":"2027-10-18","qty":1},{"lieu":"Reserve","id":"1772034542894","name":"Perfuseur","date":"2030-08-13","qty":1},{"lieu":"Reserve","id":"1772034580360","name":"Prolongateur Octopus","date":"2029-02-01","qty":1},{"lieu":"Reserve","id":"1772034597836","name":"Prolongateur Octopus","date":"2027-06-30","qty":1},{"lieu":"Reserve","id":"1772034614244","name":"Parac√©tamol injectable","date":"2026-05-31","qty":1},{"lieu":"Reserve","id":"1772034647860","name":"S√©rum physiologique 100 ml injectables","date":"2027-02-28","qty":1},{"lieu":"Reserve","id":"1772034703478","name":"S√©rum physiologique injectables 500 ml","date":"2026-05-31","qty":1},{"lieu":"Reserve","id":"1772034743056","name":"RINGER lactates 500 ml injectables","date":"2027-02-28","qty":1},{"lieu":"Reserve","id":"1772034810632","name":"S√©rum physiologique 250 ml injectables","date":"2026-05-31","qty":1},{"lieu":"Reserve","id":"1772034927123","name":"Pansement MEPILEX 10 cm par 25 cm","date":"2028-01-31","qty":1},{"lieu":"Reserve","id":"1772034977582","name":"Pansement MEPILEX 7,8 cm par 10 cm","date":"2027-10-31","qty":1},{"lieu":"Reserve","id":"1772034996463","name":"Pansement MEPILEX 7,8 cm par 10 cm","date":"2028-02-29","qty":1},{"lieu":"Reserve","id":"1772035031057","name":"Pansement MEPILEX 10 cm par 10 cm","date":"2028-01-31","qty":1},{"lieu":"Reserve","id":"1772035086792","name":"Pansement ALLEVYN 10 cm par 20 cm","date":"2026-03-31","qty":1},{"lieu":"Reserve","id":"1772035263265","name":"Bande adh√©sive √©lastique 15 cm par 2,5 m","date":"2027-02-28","qty":1},{"lieu":"Reserve","id":"1772035279342","name":"Bande adh√©sive √©lastique 6 cm par 2,5 m","date":"2027-03-31","qty":1},{"lieu":"Reserve","id":"1772035295388","name":"Bande adh√©sive √©lastique 10 cm par 2,5 m","date":"2026-05-31","qty":1},{"lieu":"Reserve","id":"1772035322989","name":"Vaseline","date":"2029-04-30","qty":1},{"lieu":"Reserve","id":"1772035480083","name":"Bande extensible 4 m par 10 cm","date":"2028-05-31","qty":1},{"lieu":"Reserve","id":"1772035516089","name":"Bande adh√©sive coh√©sive 7,5 cm par 4,5 m","date":"2028-06-09","qty":1},{"lieu":"Reserve","id":"1772035568436","name":"Bande extensible 7,5 cm par 4 m","date":"2029-05-30","qty":1},{"lieu":"Reserve","id":"1772035587079","name":"Bande extensible 4 m par 7 cm","date":"2027-09-30","qty":1},{"lieu":"Reserve","id":"1772035606479","name":"Bande de cr√™pes 4 m par 7 cm","date":"2029-11-30","qty":1},{"lieu":"Reserve","id":"1772035621524","name":"Bande de cr√™pes 4 m par 10 cm","date":"2026-06-30","qty":1},{"lieu":"Reserve","id":"1772035637438","name":"Bande de cr√™pes 4 m par 10 cm","date":"2026-10-31","qty":1},{"lieu":"Reserve","id":"1772035752446","name":"Doigtier","date":"2028-05-31","qty":1},{"lieu":"Reserve","id":"1772053454592","name":"Gant taille S","date":"2029-08-28"},{"lieu":"Reserve","id":"1772053465917","name":"Gants taille M","date":"2029-07-28"},{"lieu":"Reserve","id":"1772053476493","name":"Gants taille L","date":"2029-08-28"},{"lieu":"Reserve","id":"1772053520343","name":"Lingettes d√©sinfectantes","date":"2028-04-14"},{"lieu":"Reserve","id":"1772053538240","name":"Lingettes Pampers","date":"2028-02-28"},{"lieu":"Reserve","id":"1772053573803","name":"Pansement hydro collo√Ødes 6 cm par 11 cm 1er","date":"2026-08-31"},{"lieu":"Reserve","id":"1772053588271","name":"St√©rile strip","date":"2026-12-16"},{"lieu":"Reserve","id":"1772053624898","name":"Compresse st√©rile","date":"2030-04-17"},{"lieu":"Reserve","id":"1772053639292","name":"Compresse non st√©rile","date":"2029-09-02"},{"lieu":"Reserve","id":"1772053648416","name":"Compresse non st√©rile","date":"2029-03-29"},{"lieu":"Reserve","id":"1772053683610","name":"Au st√©rile","date":"2027-02-11"},{"lieu":"Reserve","id":"1772053696984","name":"Alcool","date":"2026-03-31"},{"lieu":"Reserve","id":"1772053757003","name":"Gel hydroalcoolique","date":"2027-05-31"},{"lieu":"Reserve","id":"1772053884897","name":"Stylo d√©rmographique","date":"2028-05-31"},{"lieu":"Reserve","id":"1772053933611","name":"Bandelette glyc√©mie","date":"2026-03-05"},{"lieu":"Reserve","id":"1772053991700","name":"Compresse st√©riles","date":"2029-05-03"},{"lieu":"Reserve","id":"1772054012280","name":"S√©rum physiologique 5 ml","date":"2027-05-31"},{"lieu":"Reserve","id":"1772054030294","name":"Pince h√©mostatique Leriche","date":"2029-03-31"},{"lieu":"Reserve","id":"1772054043971","name":"Pince √† dissection fine","date":"2029-12-09"},{"lieu":"Reserve","id":"1772054058666","name":"B√©tadine alcoolique 10 ml","date":"2027-05-31"},{"lieu":"Reserve","id":"1772054094140","name":"Trocard","date":"2028-05-31"},{"lieu":"Reserve","id":"1772054116873","name":"Trocard","date":"2028-03-31"},{"lieu":"Reserve","id":"1772054141871","name":"Trocart","date":"2029-10-31"},{"lieu":"Reserve","id":"1772054165136","name":"KT rose","date":"2029-03-01"},{"lieu":"Reserve","id":"1772054178930","name":"KT Rose 1er","date":"2028-10-31"},{"lieu":"Reserve","id":"1772054205579","name":"KT vert","date":"2030-01-01"},{"lieu":"Reserve","id":"1772054298299","name":"Tegaderm","date":"2027-07-31"},{"lieu":"Reserve","id":"1772054340235","name":"Seringue 10 ml","date":"2030-07-31"},{"lieu":"Reserve","id":"1772054393873","name":"Seringue 50 ml","date":"2027-06-30"},{"lieu":"Reserve","id":"1772054409899","name":"√âosine aqueuse","date":"2026-03-31"},{"lieu":"Reserve","id":"1772054568427","name":"OPTISKIN 10 cm par 9cm","date":"2029-10-09"},{"lieu":"Reserve","id":"1772054586541","name":"OPTISKIN 10 par 9,20 cm","date":"2029-10-31"},{"lieu":"Reserve","id":"1772054610544","name":"OPTISKIN 5,3 par 8 cm","date":"2029-09-30"},{"lieu":"Reserve","id":"1772054632361","name":"Colle tissulaire","date":"2026-12-31"},{"lieu":"Reserve","id":"1772054678280","name":"St√©rile strip","date":"2028-12-26"},{"lieu":"Reserve","id":"1772054689039","name":"St√©riles strip","date":"2028-12-16"},{"lieu":"Reserve","id":"1772054707236","name":"Pansement adh√©sif st√©rile 10 cm par 20 cm","date":"2026-06-30"},{"lieu":"Reserve","id":"1772054735988","name":"Jelonet 10 cm par 10 cm","date":"2029-06-30"},{"lieu":"Reserve","id":"1772054756587","name":"JELONET5 cm par 5 cm","date":"2029-04-30"},{"lieu":"Reserve","id":"1772054781857","name":"Burn shield 20 par 20 cm","date":"2028-03-31"},{"lieu":"Reserve","id":"1772054795401","name":"Burn shield 10 par 10 cm","date":"2028-01-31"},{"lieu":"Reserve","id":"1772088957660","name":"Raccord annel√©","date":"2029-07-27"},{"lieu":"Reserve","id":"1772088987209","name":"Seringue 10 ml","date":"2029-06-30"},{"lieu":"Reserve","id":"1772089021394","name":"Mandrain souple d'intubation","date":"2029-08-31"},{"lieu":"Reserve","id":"1772089045891","name":"Filtre respirateur","date":"2029-04-30"},{"lieu":"Reserve","id":"1772089063572","name":"Champ st√©riles","date":"2029-02-28"},{"lieu":"Reserve","id":"1772089163694","name":"Sonde IOT 8 taille","date":"2028-02-29"},{"lieu":"Reserve","id":"1772089241263","name":"Sonde IOT 7.5","date":"2028-07-31"},{"lieu":"Reserve","id":"1772089278262","name":"Sonde IOT 7","date":"2028-05-31"},{"lieu":"Reserve","id":"1772089305945","name":"Sonde IOT 6.5","date":"2028-07-31"},{"lieu":"Reserve","id":"1772089378197","name":"Mac4","date":"2031-11-30"},{"lieu":"Reserve","id":"1772089613465","name":"OPTILUBE","date":"2028-04-30"},{"lieu":"MalleDC","id":"1772089984160","name":"EXACYL","date":"2026-03-31"},{"lieu":"MalleDC","id":"1772090003290","name":"Pansement plaie soufflante","date":"2026-11-30"},{"lieu":"MalleDC","id":"1772090051669","name":"OXYNORM orodispersible","date":"2026-06-30"},{"lieu":"MalleDC","id":"1772090076489","name":"Pansement am√©ricain 20 cm par 40 cm","date":"2027-07-31"},{"lieu":"MalleDC","id":"1772090103849","name":"Bistouri","date":"2028-03-31"},{"lieu":"MalleDC","id":"1772090127521","name":"Agrafeuse cutan√©e","date":"2028-02-29"},{"lieu":"MalleDC","id":"1772090163970","name":"Bande coh√©sive","date":"2027-09-30"},{"lieu":"MalleDC","id":"1772090186569","name":"Compresse st√©rile","date":"2027-05-31"},{"lieu":"MalleDC","id":"1772090205863","name":"QUICKCLOAT","date":"2028-02-03"},{"lieu":"MalleDC","id":"1772090222222","name":"Stylo d√©mographique","date":"2027-09-21"},{"lieu":"MalleDC","id":"1772090238063","name":"Pansement compressif d'urgence","date":"2027-07-17"},{"lieu":"MalleDC","id":"1772090250655","name":"Seringue 10 ml","date":"2028-05-31"},{"lieu":"MalleDC","id":"1772090268649","name":"TROCARD","date":"2028-05-31"},{"lieu":"MalleDC","id":"1772090651822","name":"KT vert","date":"2028-07-31"},{"lieu":"MalleDC","id":"1772090680557","name":"KT jaune","date":"2027-01-01"},{"lieu":"MalleDC","id":"1772090702612","name":"KT Rose","date":"2028-10-01"},{"lieu":"MalleDC","id":"1772090728241","name":"KT bleu","date":"2027-09-01"},{"lieu":"MalleDC","id":"1772090747367","name":"KT gris","date":"2027-05-01"},{"lieu":"MalleDC","id":"1772090760895","name":"Eau oxyg√©n√©e 10 ml","date":"2026-07-31"},{"lieu":"MalleDC","id":"1772090777025","name":"OPSITE adulte","date":"2027-07-31"},{"lieu":"MalleDC","id":"1772090793671","name":"OPSITE p√©diatrique","date":"2027-06-05"},{"lieu":"MalleDC","id":"1772090808316","name":"Compresse st√©rile","date":"2027-06-30"},{"lieu":"MalleDC","id":"1772090831780","name":"Stylo d'exsufflation","date":"2030-03-14"},{"lieu":"MalleDC","id":"1772090888022","name":"Pansement plaie soufflante","date":"2026-11-28"},{"lieu":"MalleDC","id":"1772090963163","name":"Pince h√©mostatique le riche","date":"2029-03-31"},{"lieu":"MalleDC","id":"1772090993104","name":"Pansement compressif d'urgence","date":"2027-07-19"},{"lieu":"MalleDC","id":"1772091027007","name":"Compresse st√©rile","date":"2028-09-30"},{"lieu":"MalleDC","id":"1772091038901","name":"Agrafeuse cutan√©e","date":"2027-11-28"},{"lieu":"MalleDC","id":"1772091100265","name":"Gants taille L","date":"2029-10-31"},{"lieu":"MalleDC","id":"1772091130879","name":"Banc de coh√©sif de contention 10 cm par 2,25 m","date":"2026-09-26"},{"lieu":"MalleDC","id":"1772091144041","name":"Adr√©naline","date":"2026-06-30"},{"lieu":"MalleDC","id":"1772091179378","name":"OPSITE adulte","date":"2027-10-22"},{"lieu":"MalleDC","id":"1772091201675","name":"Chlorure de sodium 100 ml","date":"2026-11-30"},{"lieu":"MalleDC","id":"1772091223941","name":"Ringer lactate 500 ml","date":"2027-02-28"},{"lieu":"MalleDC","id":"1772091239831","name":"B√©tadine alcoolique","date":"2027-05-31"},{"lieu":"MalleDC","id":"1772091257861","name":"ISOFUNDINE 500 ml","date":"2027-03-31"},{"lieu":"MalleDC","id":"1772091278756","name":"Chlorure de sodium 250 ml","date":"2027-07-31"},{"lieu":"MalleDC","id":"1772091288229","name":"Chlorure de sodium 250 ml","date":"2027-03-31"},{"lieu":"MalleDC","id":"1772091298090","name":"Perfuseur","date":"2030-08-13"},{"lieu":"Reserve","id":"1772092418456","name":"Savon main","date":"2027-03-31"},{"lieu":"Reserve","id":"1772092629529","name":"Test de d√©pistage stup√©fiant","date":"2027-06-30"},{"lieu":"Reserve","id":"1772092639298","name":"Test de d√©pistage stup√©fiant","date":"2027-08-31"},{"lieu":"Reserve","id":"1772092702038","name":"Test de d√©pistage stup√©fiant","date":"2027-01-02"},{"lieu":"Reserve","id":"1772092718165","name":"Bandelette urinaire","date":"2026-06-30"},{"lieu":"Reserve","id":"1772092729060","name":"Bandelette urinaire","date":"2026-04-30"},{"lieu":"Reserve","id":"1772092806541","name":"Test de d√©pistage colo-rectal","date":"2026-07-31"},{"lieu":"Reserve","id":"1772092821534","name":"Test de grossesse","date":"2027-01-23"},{"lieu":"Reserve","id":"1772092834045","name":"Test de grossesse","date":"2027-12-24"},{"lieu":"Reserve","id":"1772093105918","name":"Patch ECG","date":"2026-07-31"},{"lieu":"Reserve","id":"1772093115576","name":"Patch ECG","date":"2026-11-30"},{"lieu":"Reserve","id":"1772093142254","name":"Patch ECG","date":"2026-12-31"},{"lieu":"Reserve","id":"1772093151294","name":"Patch ECG","date":"2027-06-30"},{"lieu":"Reserve","id":"1772093159432","name":"Patch ECG","date":"2027-07-31"},{"lieu":"Reserve","id":"1772093167269","name":"Patch ECG","date":"2027-10-31"},{"lieu":"Reserve","id":"1772093189485","name":"Patch DSA","date":"2027-04-02"},{"lieu":"Reserve","id":"1772093448557","name":"Compresse non st√©rile","date":"2029-03-31"},{"lieu":"Reserve","id":"1772093550556","name":"Gants taille S","date":"2028-05-31"},{"lieu":"Reserve","id":"1772093566115","name":"Test de d√©pistage stup√©fiant","date":"2027-06-21"},{"lieu":"Reserve","id":"1772093687586","name":"Sonde de temp√©rature nasaux pharyng√©","date":"2026-08-19"},{"lieu":"Reserve","id":"1772093754604","name":"Pince de saturation p√©diatrique","date":"2026-03-01"},{"lieu":"Reserve","id":"1772093792902","name":"Capteur ETCO2 EMMA","date":"2025-08-28"},{"lieu":"Reserve","id":"1772093853369","name":"Patch ECG","date":"2027-06-19"},{"lieu":"Reserve","id":"1772093863894","name":"Patch ECG","date":"2026-12-20"},{"lieu":"Reserve","id":"1772093876270","name":"Patch DSA p√©diatrique","date":"2027-07-31"},{"lieu":"Reserve","id":"1772094484509","name":"ASPEGIC 500 mg Peros","date":"2026-06-30"},{"lieu":"Reserve","id":"1772094572373","name":"EXACYL","date":"2026-03-31"},{"lieu":"Reserve","id":"1772094609686","name":"AUGMENTIN","date":"2027-06-30"},{"lieu":"Reserve","id":"1772094652064","name":"ATROPINE","date":"2027-05-31"},{"lieu":"Reserve","id":"1772094678090","name":"CEFTRIAXONE","date":"2026-06-30"},{"lieu":"Reserve","id":"1772094727188","name":"CORDARONE","date":"2027-01-31"},{"lieu":"Reserve","id":"1772094744641","name":"DIAZEPAM","date":"2026-10-31"},{"lieu":"Reserve","id":"1772094835125","name":"G10 % injectables","date":"2026-09-30"},{"lieu":"Reserve","id":"1772094861538","name":"G 30 % injectables","date":"2026-09-30"},{"lieu":"Reserve","id":"1772094954843","name":"KETOPROFENE injectable","date":"2026-05-31"},{"lieu":"Reserve","id":"1772094989633","name":"POLARAMINE injectables","date":"2026-03-31"},{"lieu":"Reserve","id":"1772095056371","name":"HEPARINE injectables","date":"2028-03-31"},{"lieu":"Reserve","id":"1772095255263","name":"IPRATROPIUM p√©diatrique","date":"2027-02-28"},{"lieu":"Reserve","id":"1772095299409","name":"IPRATROPIUM adulte","date":"2026-09-30"},{"lieu":"Reserve","id":"1772095475362","name":"PHLOROGLUCINOL injectables","date":"2026-04-30"},{"lieu":"Reserve","id":"1772095606888","name":"METHYLPREDNISOLONE","date":"2026-06-30"},{"lieu":"Reserve","id":"1772095627356","name":"ISOCARD","date":"2027-09-30"},{"lieu":"Reserve","id":"1772095714162","name":"BRILIQUE","date":"2027-08-31"},{"lieu":"Reserve","id":"1772095733657","name":"RIVOTRIL","date":"2028-07-31"},{"lieu":"Reserve","id":"1772095793957","name":"METOCLOPRAMIDE","date":"2028-01-31"},{"lieu":"Reserve","id":"1772095811751","name":"METOCLOPRAMIDE","date":"2029-05-31"},{"lieu":"Reserve","id":"1772095852082","name":"RISORDAN","date":"2026-06-30"},{"lieu":"Reserve","id":"1772095875592","name":"PLAVIX","date":"2027-01-31"},{"lieu":"Reserve","id":"1772095969447","name":"AUGMENTIN","date":"2026-12-31"},{"lieu":"Reserve","id":"1772095987359","name":"AMOXICI2LINE","date":"2026-09-30"},{"lieu":"Reserve","id":"1772096051957","name":"CIPROFLOXACINE","date":"2026-12-31"},{"lieu":"Reserve","id":"1772096064229","name":"CIPROFLOXACINE","date":"2027-01-31"},{"lieu":"Reserve","id":"1772096114202","name":"RIFADINE","date":"2027-11-30"},{"lieu":"Reserve","id":"1772096169793","name":"CETIRIZINE","date":"2026-10-31"},{"lieu":"Reserve","id":"1772096210822","name":"Doliprane","date":"2028-05-31"},{"lieu":"Reserve","id":"1772096314797","name":"PANTORRAZOLE 20 mg","date":"2027-03-31"},{"lieu":"Reserve","id":"1772096375042","name":"PHLOROGLUCINOL","date":"2027-07-31"},{"lieu":"Reserve","id":"1772096451169","name":"RACECADOTRIL","date":"2027-01-31"},{"lieu":"Reserve","id":"1772096465741","name":"DIOMECTITE","date":"2026-12-31"},{"lieu":"Reserve","id":"1772096554533","name":"SALBUTAMOL inhaler","date":"2027-05-31"},{"lieu":"Reserve","id":"1772096614023","name":"SALBUTAMOL inhal√©","date":"2028-04-30"},{"lieu":"Reserve","id":"1772096642304","name":"VENTOLINE","date":"2026-10-31"},{"lieu":"Reserve","id":"1772096764295","name":"FLUORESCEINE","date":"2026-09-30"},{"lieu":"Reserve","id":"1772096827914","name":"PREDNISONE 20 mg","date":"2026-09-30"},{"lieu":"Reserve","id":"1772096847093","name":"BETAMETHASONE","date":"2026-11-30"},{"lieu":"Reserve","id":"1772096896411","name":"ELUDRIL bain de bouche","date":"2026-10-31"},{"lieu":"Reserve","id":"1772096916838","name":"Bain de bouche √† la chlorhexidine","date":"2026-11-30"},{"lieu":"Reserve","id":"1772097029843","name":"KETOPROFENE 100 mg","date":"2026-06-28"},{"lieu":"Reserve","id":"1772097139015","name":"LIDOCAINE injectables","date":"2026-04-30"},{"lieu":"Reserve","id":"1772097171594","name":"Lidoca√Øne buccale","date":"2026-10-31"},{"lieu":"Reserve","id":"1772097206608","name":"ECONAZOLE poudre","date":"2027-01-31"},{"lieu":"Reserve","id":"1772097217800","name":"ECONAZOLE poudre","date":"2027-07-31"},{"lieu":"Reserve","id":"1772097242329","name":"Bouchon Lovenox","date":"2029-05-31"},{"lieu":"Reserve","id":"1772097329632","name":"Lovenox 4000 unit√©s","date":"2027-09-30"},{"lieu":"Reserve","id":"1772097751411","name":"Chlorhexidine bain de bouche","date":"2026-11-30"},{"lieu":"Reserve","id":"1772097764721","name":"Chlorhexidine bain de bouche","date":"2027-02-28"},{"lieu":"Reserve","id":"1772097874259","name":"CYANOKIT","date":"2028-06-11"},{"lieu":"Reserve","id":"1772097933662","name":"DOXYCYCLINE","date":"2027-03-31"},{"lieu":"Reserve","id":"1772097976830","name":"Spray anti moustique","date":"2026-05-31"},{"lieu":"Reserve","id":"1772098023800","name":"Cr√®me solaire","date":"2027-02-28"},{"lieu":"Reserve","id":"1772098059978","name":"S√©rum physiologique 100 ml","date":"2026-03-31"},{"lieu":"Reserve","id":"1772098102746","name":"S√©rum physiologique 500 ml","date":"2026-05-31"},{"lieu":"Reserve","id":"1772098116919","name":"S√©rum physiologique 250 ml","date":"2026-05-31"},{"lieu":"Reserve","id":"1772098183778","name":"RINGER LACTATE 500 ml","date":"2027-02-28"},{"lieu":"Reserve","id":"1772098216603","name":"DIPHOTERINE","date":"2027-05-31"},{"lieu":"Reserve","id":"1772098264590","name":"TOXICARB","date":"2026-04-30"},{"lieu":"Reserve","id":"1772098330917","name":"Glucose 5 % 50 ml injectables","date":"2026-05-31"},{"lieu":"Reserve","id":"1772098365464","name":"S√©rum physiologique 250 ml injectables","date":"2027-07-31"},{"lieu":"Reserve","id":"1772098381257","name":"Perfuser","date":"2030-08-13"},{"lieu":"Reserve","id":"1772098693610","name":"NORADRENALINE","date":"2027-06-30"},{"lieu":"Reserve","id":"1772098841354","name":"Seringue 10 ml","date":"2028-05-31"},{"lieu":"Reserve","id":"1772098915706","name":"Aiguille de m√©soth√©rapie","date":"2027-03-31"},{"lieu":"Reserve","id":"1772098984160","name":"MESOCAINE","date":"2027-02-28"},{"lieu":"Reserve","id":"1772099031568","name":"PIROXICAM injectables","date":"2026-11-30"},{"lieu":"Reserve","id":"1772099044895","name":"PIROXICAM injectables","date":"2026-07-31"},{"lieu":"Reserve","id":"1772099141205","name":"Gel √©chographie uni dose","date":"2028-06-30"},{"lieu":"Reserve","id":"1772099165394","name":"Gel √©chographie uni dose","date":"2028-07-31"},{"lieu":"Reserve","id":"1772099215654","name":"Gel √©chographie uni dose","date":"2029-05-31"},{"lieu":"Reserve","id":"1772099252571","name":"Gel √©chographie flacon","date":"2026-04-26"},{"lieu":"Reserve","id":"1772099386686","name":"Masque √† oxyg√®ne haute concentration adulte","date":"2027-06-30"},{"lieu":"Reserve","id":"1772099399464","name":"Masque √† oxyg√®ne adulte haute concentration","date":"2029-07-31"},{"lieu":"Reserve","id":"1772099438133","name":"Masque √† oxyg√®ne haute concentration p√©diatrique","date":"2027-02-28"},{"lieu":"Reserve","id":"1772099501082","name":"GELCAT Unidose","date":"2028-04-30"},{"lieu":"Reserve","id":"1772099544150","name":"BAVU p√©diatrique","date":"2028-02-05"},{"lieu":"Reserve","id":"1772099556159","name":"BAVU p√©diatrique","date":"2026-06-17"},{"lieu":"Reserve","id":"1772099566852","name":"BAVU adulte","date":"2026-08-13"},{"lieu":"Reserve","id":"1772099707034","name":"Lame d'intubation mil1","date":"2031-01-31"},{"lieu":"Reserve","id":"1772099844639","name":"Filtre respirateur p√©diatrique","date":"2030-09-12"},{"lieu":"Reserve","id":"1772099872349","name":"Raccord annel√©","date":"2029-07-31"},{"lieu":"Reserve","id":"1772099917422","name":"Filtre respirateur adulte 1er","date":"2027-05-31"},{"lieu":"Reserve","id":"1772099980876","name":"Canule intra rectal","date":"2026-08-31"},{"lieu":"Reserve","id":"1772100007908","name":"Canule grise","date":"2029-06-30"},{"lieu":"Reserve","id":"1772100021065","name":"Canule jaune","date":"2028-03-31"},{"lieu":"Reserve","id":"1772100049538","name":"Canule grise","date":"2029-10-17"},{"lieu":"Reserve","id":"1772100062409","name":"Canule bleu","date":"2028-10-31"},{"lieu":"Reserve","id":"1772100079569","name":"Canule rouge 1er","date":"2028-06-30"},{"lieu":"Reserve","id":"1772100106927","name":"Canule rouge","date":"2029-07-03"},{"lieu":"Reserve","id":"1772100234390","name":"Masque n√©bulisateurs adulte","date":"2028-01-06"},{"lieu":"Reserve","id":"1772100260688","name":"Masque inhalateur p√©diatrique","date":"2027-02-28"},{"lieu":"Reserve","id":"1772100311069","name":"Lunettes √† oxyg√®ne adulte","date":"2029-05-31"},{"lieu":"Reserve","id":"1772100324279","name":"Lunettes √† oxyg√®ne p√©diatrique","date":"2028-02-29"},{"lieu":"Reserve","id":"1772100378812","name":"Masque MEOPA jaune","date":"2030-04-30"},{"lieu":"Reserve","id":"1772100390571","name":"Masque MEOPA jaune","date":"2028-07-31"},{"lieu":"Reserve","id":"1772100411586","name":"Masque MEOPA vert","date":"2029-04-30"},{"lieu":"Reserve","id":"1772100441428","name":"Masque MEOPA vert","date":"2029-12-31"},{"lieu":"Reserve","id":"1772100453353","name":"Masque MEOPA vert","date":"2026-09-30"},{"lieu":"Reserve","id":"1772100469295","name":"Masque MEOPA blanc","date":"2026-10-31"},{"lieu":"Reserve","id":"1772100482325","name":"Masque MEOPA gris","date":"2030-04-30"},{"lieu":"Reserve","id":"1772100560690","name":"Circuit MEOPA adulte","date":"2028-06-30"},{"lieu":"Reserve","id":"1772100607821","name":"Seringue NACL pr√© rempli","date":"2028-03-31"},{"lieu":"Reserve","id":"1772100643770","name":"Sonde de temp√©rature rectal","date":"2026-08-19"},{"lieu":"Reserve","id":"1772100666465","name":"Stylo d√©mographique","date":"2028-05-31"},{"lieu":"Reserve","id":"1772100687609","name":"Circuit d'√©vacuation des gaz MEOPA","date":"2028-03-31"},{"lieu":"Reserve","id":"1772100698635","name":"Circuit d'√©vacuation des gaz MEOPA","date":"2027-09-30"},{"lieu":"Reserve","id":"1772100764794","name":"Tubulure ACCUVAC","date":"2028-06-03"},{"lieu":"Reserve","id":"1772100776252","name":"Tubulure ACCUVAC","date":"2027-03-11"},{"lieu":"Reserve","id":"1772100821296","name":"Poche de recueil ACCUVAC","date":"2028-05-08"},{"lieu":"Reserve","id":"1772100955371","name":"Sonde d'aspiration FR12","date":"2029-06-27"},{"lieu":"Reserve","id":"1772100985366","name":"Sonde d'aspiration FR 18","date":"2028-05-08"},{"lieu":"Reserve","id":"1772101014892","name":"Sonde d'aspiration FR 10","date":"2029-06-21"},{"lieu":"Reserve","id":"1772101047421","name":"Sonde d'aspiration FR08","date":"2028-08-16"},{"lieu":"Reserve","id":"1772101074454","name":"Sonde d'aspiration FR 06","date":"2029-04-11"},{"lieu":"Reserve","id":"1772101112354","name":"Collecteur √† urine","date":"2027-04-28"},{"lieu":"Reserve","id":"1772101150655","name":"Sonde d'aspiration BUCO 26","date":"2027-11-25"},{"lieu":"Reserve","id":"1772101165917","name":"Sonde d'aspiration BUCO 26","date":"2029-05-10"},{"lieu":"Reserve","id":"1772101183460","name":"Poche √† urine","date":"2027-02-28"},{"lieu":"Reserve","id":"1772101230421","name":"Circuit respirateur p√©diatrique","date":"2029-03-31"},{"lieu":"Reserve","id":"1772101270476","name":"Circuit respirateur adulte","date":"2030-02-12"},{"lieu":"Reserve","id":"1772101362750","name":"Patch DSA adulte","date":"2027-12-03"},{"lieu":"Reserve","id":"1772101378228","name":"Patch DSA p√©diatrique","date":"2027-07-28"},{"lieu":"Reserve","id":"1772101456971","name":"Sonde gastrique FR 18","date":"2027-05-31"},{"lieu":"Reserve","id":"1772101474138","name":"Sonde gastrique FR 18","date":"2029-10-28"},{"lieu":"Reserve","id":"1772101490567","name":"Sonde gastrique FR 18","date":"2028-01-31"},{"lieu":"Reserve","id":"1772101534657","name":"Sonde gastrique  FR14","date":"2026-12-03"},{"lieu":"Reserve","id":"1772101550336","name":"Sonde gastrique FR 06","date":"2029-02-19"},{"lieu":"Reserve","id":"1772101581464","name":"Tubes laryng√©e taille 2","date":"2026-07-31"},{"lieu":"Reserve","id":"1772101678257","name":"Sonde d'intubation taille 4","date":"2028-05-31"},{"lieu":"Reserve","id":"1772101707187","name":"Sonde d'intubation taille quatre","date":"2029-07-31"},{"lieu":"Reserve","id":"1772101726366","name":"Sonde d'intubation taille cinq","date":"2028-05-31"},{"lieu":"Reserve","id":"1772101746826","name":"Sonde d'intubation taille 5,5","date":"2026-10-31"},{"lieu":"Reserve","id":"1772101773105","name":"Sonde d'intubation taille 6,0","date":"2029-02-28"},{"lieu":"Reserve","id":"1772101811326","name":"Sonde d'intubation taille 3,5","date":"2028-05-31"},{"lieu":"Reserve","id":"1772104877434","name":"Sonde IOT taille 2,5","date":"2028-11-30"},{"lieu":"Reserve","id":"1772104916372","name":"Sonde IOT taille trois","date":"2028-08-31"},{"lieu":"Reserve","id":"1772104942546","name":"Sonde IOT taille 4,5","date":"2028-07-31"},{"lieu":"Reserve","id":"1772104978660","name":"Patch ECG","date":"2027-07-28"},{"lieu":"Reserve","id":"1772107609717","name":"Aiguille prise de sang ponction franche","date":"2030-01-31"},{"lieu":"Reserve","id":"1772107651498","name":"Pansement LEUKOMED 5 cm par 7,2 cm 1er","date":"2028-03-01"},{"lieu":"MalleDC","id":"1772107695400","name":"Fils de suture","date":"2026-05-31"},{"lieu":"Reserve","id":"1772108076746","name":"S√©rum physiologique 5 ml","date":"2027-08-31"},{"lieu":"Reserve","id":"1772108099504","name":"S√©rum physiologique 5 ml","date":"2028-01-31"},{"lieu":"Reserve","id":"1772108198473","name":"S√©rum physiologique 20 ml","date":"2028-04-30"},{"lieu":"Reserve","id":"1772108228084","name":"DAKIN","date":"2026-09-30"},{"lieu":"Reserve","id":"1772108251378","name":"EOSINE","date":"2026-03-31"},{"lieu":"Reserve","id":"1772108285067","name":"B√©tadine alcoolique","date":"2028-06-30"},{"lieu":"Reserve","id":"1772108309604","name":"ChloraPrep","date":"2027-05-31"},{"lieu":"Reserve","id":"1772108430910","name":"Gel FLECTOR","date":"2028-01-16"},{"lieu":"Reserve","id":"1772108443056","name":"Gel FLECTOR","date":"2027-04-25"},{"lieu":"Reserve","id":"1772108627127","name":"B√©tadine gel","date":"2027-07-31"},{"lieu":"Reserve","id":"1772108740831","name":"Alcool modifi√©","date":"2027-11-30"},{"lieu":"Reserve","id":"1772108750105","name":"Alcool modifi√© p√©ri","date":"2028-06-30"},{"lieu":"Reserve","id":"1772108759580","name":"Alcool modifi√© p√©ri","date":"2026-03-31"},{"lieu":"Reserve","id":"1772108900517","name":"Bande adh√©sif √©lastique TENSOPLAST 15 cm par 2,5 m p√©ri","date":"2027-02-28"},{"lieu":"Reserve","id":"1772109012239","name":"Bande adh√©sive √©lastique TENSOPLAST 10 cm par 2,5 m","date":"2026-05-31"},{"lieu":"Reserve","id":"1772109032686","name":"Bande adh√©sive √©lastique TENSOPLAST 10 cm par 2,5 m","date":"2026-07-31"},{"lieu":"Reserve","id":"1772109127536","name":"Bande adh√©sive √©lastique TENSOPLAST6 cm par 2,5 m p√©ri","date":"2027-03-31"},{"lieu":"Reserve","id":"1772109174589","name":"Bande adh√©sive √©lastique TENSOPLAST6 cm par 2,5 m","date":"2027-11-30"},{"lieu":"Reserve","id":"1772109206767","name":"Bande adh√©sive √©lastique STRAPPAL4 cm par 10 m","date":"2027-06-30"},{"lieu":"Reserve","id":"1772109235732","name":"Rouleaux de sparadrap","date":"2028-05-04"},{"lieu":"Reserve","id":"1772109287242","name":"Bande de fixation coh√©sive de 10 cm par 4 m","date":"2027-09-30"},{"lieu":"Reserve","id":"1772109358386","name":"Bande de fixation coh√©sive de 10 cm par 2 m","date":"2026-09-30"},{"lieu":"Reserve","id":"1772109376479","name":"Bande de fixation coh√©sive de 10 cm par 2 m","date":"2027-09-02"},{"lieu":"Reserve","id":"1772109524055","name":"Bande √©lastique coh√©sive de 7,5 cm par 4,5 m","date":"2028-06-09"},{"lieu":"Reserve","id":"1772109550775","name":"Bande √©lastique de contention de 3 m par 7 cm p√©ri","date":"2027-11-30"},{"lieu":"Reserve","id":"1772109759297","name":"Bande √©lastique coh√©sive de 2,5 cm par 2 m","date":"2026-05-22"},{"lieu":"Reserve","id":"1772109875863","name":"Bande extensible blanche de 4 m par 10 cm","date":"2028-05-31"},{"lieu":"Reserve","id":"1772109952123","name":"Bande extensible blanche de 10 cm par 4 m","date":"2029-11-30"},{"lieu":"Reserve","id":"1772109976559","name":"Bande extensible blanche de 4 m par 10 cm","date":"2028-03-31"},{"lieu":"Reserve","id":"1772110173246","name":"Bande d'extensible blanche de 7 cm par 4 m","date":"2029-04-30"},{"lieu":"Reserve","id":"1772110293809","name":"Aiguille sous-cutan√©e jaune","date":"2026-06-30"},{"lieu":"Reserve","id":"1772110402685","name":"Bande de cr√™pes de 4 m par 10 cm","date":"2027-09-30"},{"lieu":"Reserve","id":"1772110480411","name":"Bande de cr√™pes de 7 cm par 4 m","date":"2029-04-30"},{"lieu":"Reserve","id":"1772110500643","name":"Bande de cr√™pes de 4 m par 7 cm","date":"2029-11-30"},{"lieu":"Reserve","id":"1772110525638","name":"Bande de cr√™pes de 4 m par 7 cm","date":"2028-03-31"},{"lieu":"Reserve","id":"1772110648852","name":"Compresse st√©rile","date":"2029-03-25"},{"lieu":"Reserve","id":"1772110677892","name":"Compresse st√©rile","date":"2030-03-12"},{"lieu":"Reserve","id":"1772110736458","name":"Compresse non st√©rile","date":"2026-05-31"},{"lieu":"Reserve","id":"1772110972376","name":"SET pour pansement st√©rile","date":"2029-09-30"},{"lieu":"Reserve","id":"1772110985019","name":"SET pour pansement st√©rile","date":"2030-02-28"},{"lieu":"Reserve","id":"1772111085346","name":"DUODERM de 6 cm par 11 cm","date":"2026-08-31"},{"lieu":"Reserve","id":"1772111118403","name":"DUODERM de 6 cm par 11 cm","date":"2027-03-01"},{"lieu":"Reserve","id":"1772111159833","name":"DUODERM de 6 cm par 11 cm","date":"2027-07-02"},{"lieu":"Reserve","id":"1772111190383","name":"GEL anti adh√©sif","date":"2027-05-31"},{"lieu":"Reserve","id":"1772111218045","name":"JELONET5 cm par 5 cm","date":"2029-05-01"},{"lieu":"Reserve","id":"1772111237445","name":"JELONET de 10 cm par 10 cm","date":"2028-12-01"},{"lieu":"Reserve","id":"1772111282251","name":"Bande de gaz OPRACLEAN de 2 cm par 5 m","date":"2026-04-30"},{"lieu":"Reserve","id":"1772111345402","name":"M√®che nasale","date":"2027-09-22"},{"lieu":"Reserve","id":"1772111393488","name":"M√®che h√©mostatique cicatrisante COALGAN","date":"2028-05-31"},{"lieu":"Reserve","id":"1772111456459","name":"AQUACEL de 2,5 cm par 48 cm","date":"2030-06-01"},{"lieu":"Reserve","id":"1772111536737","name":"Doigtier","date":"2027-06-30"},{"lieu":"Reserve","id":"1772111609235","name":"Pansement SYLAPLAIE de 10 cm par 20 cm p√©ri","date":"2026-06-30"},{"lieu":"Reserve","id":"1772111679497","name":"Pansement OPTISKIN de 10 cm par 9 cm","date":"2029-10-31"},{"lieu":"Reserve","id":"1772111701586","name":"Pansement OPTISKIN de 10 cm par 9 cm","date":"2028-12-31"},{"lieu":"Reserve","id":"1772111859767","name":"Pansement OPTISKIN de 5,3 cm par 8 cm","date":"2028-09-30"},{"lieu":"Reserve","id":"1772111889312","name":"Pansement OPTISKIN de 5,3 cm par 8 cm","date":"2029-10-31"},{"lieu":"Reserve","id":"1772111946299","name":"Pansement OPTISKIN de 5,3 cm par 8 cm","date":"2029-09-30"},{"lieu":"Reserve","id":"1772112135694","name":"Pansement LEUKOMED de 5 cm par 7,2 cm p√©ri","date":"2028-03-01"},{"lieu":"Reserve","id":"1772112351783","name":"Pansement MEPILEX ovale","date":"2027-10-31"},{"lieu":"Reserve","id":"1772112367685","name":"Pansement MEPILEX oval","date":"2028-02-29"},{"lieu":"Reserve","id":"1772112396648","name":"Pansement MEPILEX carr√©","date":"2028-01-31"},{"lieu":"Reserve","id":"1772112409857","name":"Pansement MEPILEX carr√©","date":"2028-02-29"},{"lieu":"Reserve","id":"1772112482685","name":"Pansement MEPILEX rectangulaire grand mod√®le","date":"2027-09-30"},{"lieu":"Reserve","id":"1772112495092","name":"Pansement MEPILEX rectangulaire grand mod√®le","date":"2028-01-31"},{"lieu":"Reserve","id":"1772112512254","name":"Pansement MEPILEX rectangulaire grand mod√®le","date":"2028-05-31"},{"lieu":"Reserve","id":"1772112545005","name":"Pansement ALL EVYN rectangulaire 10 cm par 10 cm p√©ri","date":"2027-03-01"},{"lieu":"Reserve","id":"1772112571494","name":"Pansement ALLEVYN en √©toile","date":"2028-03-01"},{"lieu":"Reserve","id":"1772112594790","name":"Pansement MEPILEX carr√© grand mod√®le","date":"2028-02-29"},{"lieu":"Reserve","id":"1772112799846","name":"Colle pour suture cutan√©e","date":"2026-08-31"},{"lieu":"Reserve","id":"1772112896663","name":"STERISTRIP","date":"2027-12-16"},{"lieu":"Reserve","id":"1772112915811","name":"STERISTRIP","date":"2028-12-26"},{"lieu":"Reserve","id":"1772112934271","name":"STERISTRIP","date":"2029-03-12"},{"lieu":"Reserve","id":"1772113065855","name":"ETHILON 2-0","date":"2027-09-30"},{"lieu":"Reserve","id":"1772113104838","name":"Fil de suture deux-zero","date":"2027-11-30"},{"lieu":"Reserve","id":"1772113120501","name":"Fil de suture quatre-zero","date":"2027-11-30"},{"lieu":"Reserve","id":"1772113133163","name":"File de suture cinq-zero","date":"2026-12-31"},{"lieu":"Reserve","id":"1772113145804","name":"Fil de suture six-zero","date":"2027-06-30"},{"lieu":"Stups","id":"1772117852022","name":"OROZUMADOLE","date":"2026-05-31"},{"lieu":"Stups","id":"1772117877824","name":"MORPHINE","date":"2028-03-31"},{"lieu":"Stups","id":"1772117965938","name":"MIDAZOLAM 5 mg","date":"2027-01-31"},{"lieu":"Stups","id":"1772117977013","name":"KETAMINE","date":"2027-02-28"},{"lieu":"Stups","id":"1772117992169","name":"CODOLIPRANE","date":"2026-03-31"},{"lieu":"Stups","id":"1772118055842","name":"MIDAZOLAM 50 mg","date":"2027-06-30"},{"lieu":"Reserve","id":"1772118155945","name":"Seringue 20 ml","date":"2030-01-01"},{"lieu":"Reserve","id":"1772118244018","name":"KT gris","date":"2027-05-01"},{"lieu":"Reserve","id":"1772118309913","name":"Agrafeuse","date":"2027-11-30"},{"lieu":"Reserve","id":"1772118321424","name":"Agrafeuse","date":"2027-07-31"},{"lieu":"Reserve","id":"1772118343549","name":"Pince haute agrafes","date":"2027-04-30"},{"lieu":"Reserve","id":"1772118430938","name":"Cette ablation de suture","date":"2029-10-15"},{"lieu":"Reserve","id":"1772118478226","name":"SET de suture","date":"2027-04-30"},{"lieu":"Reserve","id":"1772118588702","name":"OPSITE p√©diatrique","date":"2027-07-05"},{"lieu":"Reserve","id":"1772118621569","name":"OPSITE p√©diatrique","date":"2027-06-05"},{"lieu":"Reserve","id":"1772118650676","name":"OPSITE adulte","date":"2027-10-31"},{"lieu":"Reserve","id":"1772118661130","name":"OPSITE adulte","date":"2027-07-31"},{"lieu":"Reserve","id":"1772118707137","name":"OPSITE p√©diatrique","date":"2027-08-01"},{"lieu":"Reserve","id":"1772118758592","name":"OPSITE adulte","date":"2029-08-31"},{"lieu":"Reserve","id":"1772119063900","name":"Masque oxyg√®ne haute concentration taille adulte","date":"2027-06-30"},{"lieu":"Reserve","id":"1772119147547","name":"Pr√©servatif","date":"2029-05-31"},{"lieu":"Reserve","id":"1772119256949","name":"Lingettes Pampers","date":"2028-02-29"},{"lieu":"Reserve","id":"1772178495943","name":"Spray surface Safe","date":"2027-06-30"},{"lieu":"Reserve","id":"1772178614711","name":"Gel hydroalcoolique petit mod√®le","date":"2028-05-31"},{"lieu":"Reserve","id":"1772178710879","name":"Al√®se absorbant","date":"2030-06-19"},{"lieu":"Reserve","id":"1772178782292","name":"Savon doux pour les mains","date":"2027-03-31"},{"lieu":"Reserve","id":"1772178804397","name":"Savon doux pour les mains","date":"2027-08-31"},{"lieu":"Reserve","id":"1772178822831","name":"Savon doux pour les mains","date":"2028-02-29"},{"lieu":"Reserve","id":"1772178876894","name":"Gel hydroalcoolique grand mod√®le","date":"2027-05-31"},{"lieu":"Reserve","id":"1772178887586","name":"Gel hydroalcoolique grand mod√®le","date":"2026-04-30"},{"lieu":"Reserve","id":"1772178956304","name":"Gant taille M","date":"2028-05-31"},{"lieu":"Reserve","id":"1772178966564","name":"Gant taille M peri","date":"2027-05-31"},{"lieu":"Reserve","id":"1772178984437","name":"Gants taille XL","date":"2029-08-31"},{"lieu":"Reserve","id":"1772179040416","name":"Gants taille L","date":"2029-08-31"},{"lieu":"Reserve","id":"1772180304097","name":"Masque FFP trois","date":"2027-06-30"},{"lieu":"Reserve","id":"1772180334852","name":"Test de grossesse","date":"2027-12-31"},{"lieu":"Reserve","id":"1772180351128","name":"COLDPACK","date":"2030-03-31"},{"lieu":"Reserve","id":"1772180366707","name":"Couverture de r√©chauffement active","date":"2029-04-30"},{"lieu":"Reserve","id":"1772180381114","name":"Couverture de r√©chauffement active","date":"2029-05-31"},{"lieu":"Reserve","id":"1772180414182","name":"M√®che h√©mostatique cicatrisante de 40 cm","date":"2027-06-30"},{"lieu":"Reserve","id":"1772180472973","name":"Test angine","date":"2026-01-31"},{"lieu":"Reserve","id":"1772180494452","name":"BURNSHIELD 10 cm par 10 cm peri","date":"2028-01-31"},{"lieu":"Reserve","id":"1772180517902","name":"QUICKCLOT","date":"2028-04-30"},{"lieu":"Reserve","id":"1772180534461","name":"Pansement pour plaie soufflante","date":"2026-11-30"},{"lieu":"Reserve","id":"1772180550641","name":"Pansement compressif d'urgence","date":"2028-11-30"},{"lieu":"Reserve","id":"1772180596405","name":"Test de d√©pistage stup√©fiant","date":"2027-01-31"},{"lieu":"Reserve","id":"1772180654175","name":"BURNSHIELD 20 cm par 20 cm","date":"2028-04-30"},{"lieu":"Reserve","id":"1772180749864","name":"BURNSHIELD 20 cm par 20 cm","date":"2028-03-31"},{"lieu":"Reserve","id":"1772180789321","name":"Pansement M√©talline","date":"2027-11-30"},{"lieu":"Reserve","id":"1772180813950","name":"Pansement M√©talline","date":"2029-01-31"},{"lieu":"Reserve","id":"1772180851343","name":"BURNSHIELD facial","date":"2027-03-31"},{"lieu":"Reserve","id":"1772180866585","name":"Ceinture pelvienne","date":"2026-07-31"},{"lieu":"Reserve","id":"1772180892046","name":"Pansement absorbant de 15 cm par 20 cm","date":"2028-06-30"},{"lieu":"Reserve","id":"1772180911875","name":"Pansement absorbant de 20 cm par 40 cm","date":"2029-05-31"},{"lieu":"Reserve","id":"1772180938820","name":"Test de cancer du colo-rectal","date":"2026-07-31"},{"lieu":"Reserve","id":"1772181367146","name":"Aiguille sous cutan√©e orange","date":"2026-06-30"},{"lieu":"Reserve","id":"1772181413399","name":"Aiguille IV noir","date":"2026-09-30"},{"lieu":"Reserve","id":"1772181463306","name":"Aiguille IM verte","date":"2029-03-31"},{"lieu":"Reserve","id":"1772181493654","name":"TROCARD","date":"2029-10-31"},{"lieu":"Reserve","id":"1772181536208","name":"KT bleu","date":"2030-07-31"},{"lieu":"Reserve","id":"1772181612479","name":"KT bleu","date":"2027-09-30"},{"lieu":"Reserve","id":"1772181625738","name":"KT bleu","date":"2029-02-01"},{"lieu":"Reserve","id":"1772181692809","name":"KT jaune","date":"2030-02-01"},{"lieu":"Reserve","id":"1772181709040","name":"KT jaune","date":"2027-11-01"},{"lieu":"Reserve","id":"1772181725052","name":"KT jaune","date":"2027-01-01"},{"lieu":"Reserve","id":"1772181784882","name":"KT rose","date":"2030-06-01"},{"lieu":"Reserve","id":"1772181798693","name":"KT rose","date":"2028-10-01"},{"lieu":"Reserve","id":"1772181841546","name":"KT vert","date":"2029-08-01"},{"lieu":"Reserve","id":"1772181888883","name":"KT vert","date":"2030-04-01"},{"lieu":"Reserve","id":"1772182010027","name":"KT gris","date":"2030-01-01"},{"lieu":"Reserve","id":"1772183224401","name":"Stylo d'exsufflation","date":"2031-05-31"},{"lieu":"Reserve","id":"1772185112873","name":"Adaptateur de prise de sang pour cath√©ter","date":"2027-10-31"},{"lieu":"Reserve","id":"1772185164082","name":"Aiguille prise de sang verte","date":"2030-01-31"},{"lieu":"Reserve","id":"1772185176821","name":"Aiguille prise de sang verte","date":"2029-02-28"},{"lieu":"Reserve","id":"1772185227126","name":"Seringue 50 ml","date":"2029-12-31"},{"lieu":"Reserve","id":"1772185238799","name":"Seringue 20 ml","date":"2028-12-31"},{"lieu":"Reserve","id":"1772185276681","name":"Seringue 10 ml a","date":"2030-07-31"},{"lieu":"Reserve","id":"1772185289288","name":"Seringue 5 ml","date":"2029-11-30"},{"lieu":"Reserve","id":"1772185324642","name":"Robinet 3 voie","date":"2026-10-31"},{"lieu":"Reserve","id":"1772185339735","name":"Robinet trois voies","date":"2027-08-31"},{"lieu":"Reserve","id":"1772185353130","name":"Prolongateur Octopus","date":"2029-02-28"},{"lieu":"Reserve","id":"1772185375492","name":"Seringue intra nasale","date":"2027-04-11"},{"lieu":"Reserve","id":"1772185400149","name":"Bouchon rouge","date":"2026-12-02"},{"lieu":"Reserve","id":"1772185415777","name":"Bouchons rouge","date":"2029-07-12"},{"lieu":"Reserve","id":"1772185525871","name":"Gants st√©riles taille 6,5","date":"2026-07-31"},{"lieu":"Reserve","id":"1772185546375","name":"Gants st√©riles taille 7,5","date":"2027-06-30"},{"lieu":"Reserve","id":"1772185568096","name":"Gants st√©rile taille 7,5","date":"2029-01-04"},{"lieu":"Reserve","id":"1772185584175","name":"Gants st√©rile taille 8,5","date":"2026-04-30"},{"lieu":"Reserve","id":"1772185650513","name":"Gants st√©rile taille 8,5","date":"2029-01-04"},{"lieu":"Reserve","id":"1772185681522","name":"Aiguille PIO jaune","date":"2027-11-30"},{"lieu":"Reserve","id":"1772185765053","name":"Aiguille PIO bleu","date":"2028-01-31"},{"lieu":"Reserve","id":"1772185794857","name":"Aiguille PIO rose","date":"2028-10-31"},{"lieu":"Reserve","id":"1772185848097","name":"Champ st√©riles non fen√™tres","date":"2026-04-30"},{"lieu":"Reserve","id":"1772185864305","name":"Champ st√©riles non fen√™tre","date":"2029-02-28"},{"lieu":"Reserve","id":"1772185881681","name":"Chant st√©riles fen√™tre","date":"2027-09-01"},{"lieu":"Reserve","id":"1772185899278","name":"Champ st√©rile fen√™tre","date":"2027-08-01"},{"lieu":"Reserve","id":"1772185927862","name":"Auto piqueur","date":"2027-02-01"},{"lieu":"Reserve","id":"1772185955409","name":"Ciseaux st√©rile","date":"2029-03-31"},{"lieu":"Reserve","id":"1772185972056","name":"Ciseaux st√©riles","date":"2028-05-31"},{"lieu":"Reserve","id":"1772186004455","name":"Curette","date":"2027-05-30"},{"lieu":"Reserve","id":"1772186047680","name":"Pince √† dissection plate","date":"2029-12-09"},{"lieu":"Reserve","id":"1772186106735","name":"Pince de MAGILL 200 mm","date":"2030-09-30"},{"lieu":"Reserve","id":"1772186126112","name":"Pince de MAGILL 200 mm","date":"2029-07-31"},{"lieu":"Reserve","id":"1772186170650","name":"Pince de MAGILL 250 mm","date":"2028-05-03"},{"lieu":"Reserve","id":"1772186206228","name":"Micro cuvette HEMOCUE","date":"2026-09-30"},{"lieu":"Reserve","id":"1772186224104","name":"Bandelette lactate","date":"2027-04-30"},{"lieu":"Reserve","id":"1772186284925","name":"Bandelette glyc√©mie","date":"2027-06-09"},{"lieu":"Reserve","id":"1772186321759","name":"Bistouri","date":"2029-01-01"},{"lieu":"Reserve","id":"1772186339344","name":"Bistouri","date":"2029-06-09"}];
      save();
    }
  } catch(e) { meds = []; }
}

function save() {
  try { localStorage.setItem('pharmExpiry_v2', JSON.stringify(meds)); updateSuggestions(); }
  catch(e) { toast('‚ö†Ô∏è Stockage non disponible', 'error'); }
}

loadData();
updateSuggestions();

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// STATE
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let currentTab        = 'stock';
let stockFilter       = 'all';
let lieuFilter        = 'all';
let lieuFilterMonth   = 'all';
let currentMonth      = new Date();

const LIEUX = ['Reserve', 'VSS', 'Stups', 'MalleDC', 'Vaccin'];
const LIEU_LABELS = { Reserve: 'R√©serve/SDS/Bio', VSS: 'VSS', Stups: 'Stups', MalleDC: 'Malle DC', Vaccin: 'Vaccin' };

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// TABS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function switchTab(tab) {
  currentTab = tab;
  document.getElementById('section-stock').classList.toggle('active', tab === 'stock');
  document.getElementById('section-month').classList.toggle('active', tab === 'month');
  document.getElementById('tab-stock').classList.toggle('active', tab === 'stock');
  document.getElementById('tab-month').classList.toggle('active', tab === 'month');
  if (tab === 'stock') renderStock();
  else renderMonth();
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// TOAST
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toast(msg, type = 'success') {
  const t = document.getElementById('toast');
  t.textContent = msg; t.className = 'toast ' + type; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// STATUS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getStatus(dateStr) {
  const today = new Date(); today.setHours(0,0,0,0);
  const diff = Math.floor((new Date(dateStr + 'T00:00:00') - today) / 86400000);
  return diff < 0 ? 'expired' : diff <= 30 ? 'soon' : 'ok';
}

function getDiff(dateStr) {
  const today = new Date(); today.setHours(0,0,0,0);
  return Math.floor((new Date(dateStr + 'T00:00:00') - today) / 86400000);
}

function badgeLabel(status, dateStr) {
  const diff = getDiff(dateStr);
  if (status === 'expired') return `P√©rim√© il y a ${Math.abs(diff)}j`;
  if (status === 'soon')    return `Dans ${diff}j`;
  return `OK ‚Äî ${diff}j`;
}

function statusOrder(s) { return s === 'expired' ? 0 : s === 'soon' ? 1 : 2; }

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// STATS HEADER
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateStats() {
  let expired = 0, soon = 0;
  meds.forEach(m => {
    const s = getStatus(m.date);
    if (s === 'expired') expired++;
    if (s === 'soon')    soon++;
  });
  document.querySelector('#stat-expired .n').textContent = expired;
  document.querySelector('#stat-soon .n').textContent    = soon;
  document.querySelector('#stat-total .n').textContent   = meds.length;
  document.getElementById('badge-stock').textContent     = meds.length;

  // Compteurs lieu tabs
  LIEUX.forEach(l => {
    const el = document.getElementById('count-' + l);
    if (el) el.textContent = meds.filter(m => m.lieu === l).length;
  });
  const allEl = document.getElementById('count-all');
  if (allEl) allEl.textContent = meds.length;
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// GLOBAL SUMMARY (cartes par lieu)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderGlobalSummary() {
  const container = document.getElementById('globalSummary');
  container.innerHTML = LIEUX.map(lieu => {
    const list = meds.filter(m => m.lieu === lieu);
    let exp = 0, soon = 0, ok = 0;
    list.forEach(m => { const s = getStatus(m.date); if(s==='expired') exp++; else if(s==='soon') soon++; else ok++; });
    return `
      <div class="summary-card">
        <div class="summary-card-title">
          <span class="dot dot-${lieu}"></span>
          ${LIEU_LABELS[lieu]} ‚Äî ${list.length} m√©dicament${list.length>1?'s':''}
        </div>
        <div class="summary-card-stats">
          ${exp  ? `<div class="mini-stat danger"><div class="n">${exp}</div><div class="l">P√©rim√©s</div></div>` : ''}
          ${soon ? `<div class="mini-stat warn"><div class="n">${soon}</div><div class="l">Bient√¥t</div></div>` : ''}
          <div class="mini-stat"><div class="n">${ok}</div><div class="l">OK</div></div>
        </div>
      </div>`;
  }).join('');
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// RENDER STOCK
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderStock() {
  updateStats();
  renderGlobalSummary();

  const search = document.getElementById('searchStock').value.toLowerCase();
  const sort   = document.getElementById('sortStock').value;

  let list = meds.filter(m => {
    if (!m.name.toLowerCase().includes(search)) return false;
    const s = getStatus(m.date);
    if (stockFilter !== 'all' && s !== stockFilter) return false;
    if (lieuFilter  !== 'all' && m.lieu !== lieuFilter) return false;
    return true;
  });

  list.sort((a, b) => {
    if (sort === 'status')    return statusOrder(getStatus(a.date)) - statusOrder(getStatus(b.date)) || new Date(a.date) - new Date(b.date);
    if (sort === 'date-asc')  return new Date(a.date) - new Date(b.date);
    if (sort === 'date-desc') return new Date(b.date) - new Date(a.date);
    if (sort === 'name-asc')  return a.name.localeCompare(b.name, 'fr');
    if (sort === 'name-desc') return b.name.localeCompare(a.name, 'fr');
    if (sort === 'lieu')      return LIEUX.indexOf(a.lieu) - LIEUX.indexOf(b.lieu) || new Date(a.date) - new Date(b.date);
    return 0;
  });

  const n = list.length;
  document.getElementById('stockCountLabel').textContent = `${n} m√©dicament${n > 1 ? 's' : ''}`;

  const tbody = document.getElementById('stockBody');
  const cards = document.getElementById('stockCards');
  const empty = document.getElementById('stockEmpty');

  if (list.length === 0) { tbody.innerHTML = ''; cards.innerHTML = ''; empty.style.display = 'block'; return; }
  empty.style.display = 'none';

  tbody.innerHTML = list.map(m => {
    const s     = getStatus(m.date);
    const badge = badgeLabel(s, m.date);
    const date  = new Date(m.date + 'T00:00:00').toLocaleDateString('fr-FR', { day:'2-digit', month:'long', year:'numeric' });
    return `
      <tr>
        <td class="td-name">üíä ${esc(m.name)}</td>
        <td><span class="lieu-badge lieu-${m.lieu}">${LIEU_LABELS[m.lieu]}</span></td>
        <td class="td-date">${date}</td>
        <td><span class="med-badge badge-${s}">${badge}</span></td>
        <td><div class="td-actions"><button class="med-del" onclick="deleteMed('${m.id}')" title="Supprimer">‚úï</button></div></td>
      </tr>`;
  }).join('');

  // Version cartes pour mobile
  cards.innerHTML = list.map(m => {
    const s     = getStatus(m.date);
    const badge = badgeLabel(s, m.date);
    const date  = new Date(m.date + 'T00:00:00').toLocaleDateString('fr-FR', { day:'2-digit', month:'short', year:'numeric' });
    return `
      <div class="stock-card ${s}">
        <div class="stock-card-top">
          <span class="stock-card-name">üíä ${esc(m.name)}</span>
          <span class="lieu-badge lieu-${m.lieu}">${LIEU_LABELS[m.lieu]}</span>
        </div>
        <div class="stock-card-bottom">
          <span class="stock-card-date">Exp. ${date}</span>
          <span class="med-badge badge-${s}">${badge}</span>
          <div class="stock-card-actions">
            <button class="med-del" onclick="deleteMed('${m.id}')" title="Supprimer" style="width:32px;height:32px;border-radius:8px;border:1.5px solid var(--border);background:transparent;cursor:pointer;color:var(--muted);font-size:1rem;display:flex;align-items:center;justify-content:center;transition:all 0.15s;">‚úï</button>
          </div>
        </div>
      </div>`;
  }).join('');
}

function setStockFilter(f, btn) {
  stockFilter = f;
  document.querySelectorAll('.stock-filters .filter-pill').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderStock();
}

function setLieuFilter(f, btn) {
  lieuFilter = f;
  document.querySelectorAll('#lieuTabs .lieu-tab').forEach(b => {
    b.className = 'lieu-tab';
  });
  btn.classList.add('active-' + (f === 'all' ? 'all' : f));
  renderStock();
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// RENDER PAR MOIS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderMonth() {
  updateStats();
  const y = currentMonth.getFullYear();
  const mo = currentMonth.getMonth();

  let list = meds.filter(m => {
    const exp = new Date(m.date + 'T00:00:00');
    if (exp.getFullYear() !== y || exp.getMonth() !== mo) return false;
    if (lieuFilterMonth !== 'all' && m.lieu !== lieuFilterMonth) return false;
    return true;
  }).sort((a, b) => new Date(a.date) - new Date(b.date));

  document.getElementById('badge-month').textContent = list.length || '0';

  let expC=0, soonC=0, okC=0;
  list.forEach(m => { const s=getStatus(m.date); if(s==='expired') expC++; else if(s==='soon') soonC++; else okC++; });

  const summaryEl = document.getElementById('monthSummary');
  summaryEl.innerHTML = list.length > 0 ? [
    expC  ? `<span class="summary-chip chip-expired">üî¥ ${expC} p√©rim√©${expC>1?'s':''}</span>` : '',
    soonC ? `<span class="summary-chip chip-soon">üü† ${soonC} bient√¥t</span>` : '',
    okC   ? `<span class="summary-chip chip-ok">üü¢ ${okC} OK</span>` : '',
  ].join('') : '';

  const btnExport = document.getElementById('btnExport');
  const container = document.getElementById('medList');

  if (list.length === 0) {
    btnExport.style.display = 'none';
    container.innerHTML = `
      <div class="empty-state">
        <div class="icon">üìÖ</div>
        <p>Aucun m√©dicament ne p√©rime en ${currentMonth.toLocaleDateString('fr-FR', {month:'long', year:'numeric'})}${lieuFilterMonth !== 'all' ? ' pour ' + LIEU_LABELS[lieuFilterMonth] : ''}.</p>
      </div>`;
    return;
  }

  btnExport.style.display = 'flex';
  container.innerHTML = list.map(m => {
    const s     = getStatus(m.date);
    const badge = badgeLabel(s, m.date);
    const date  = new Date(m.date + 'T00:00:00').toLocaleDateString('fr-FR', { day:'2-digit', month:'long', year:'numeric' });
    return `
      <div class="med-item ${s}">
        <div class="med-name">üíä ${esc(m.name)}</div>
        <span class="lieu-badge lieu-${m.lieu}">${LIEU_LABELS[m.lieu]}</span>
        <div class="med-date">Exp. ${date}</div>
        <span class="med-badge badge-${s}">${badge}</span>
      </div>`;
  }).join('');
}

function setLieuFilterMonth(f, btn) {
  lieuFilterMonth = f;
  document.querySelectorAll('#lieuTabsMonth .lieu-tab').forEach(b => b.className = 'lieu-tab');
  btn.classList.add('active-' + (f === 'all' ? 'all' : f));
  renderMonth();
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// NAVIGATION MOIS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateMonthDisplay() {
  const label = currentMonth.toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
  document.getElementById('monthLabel').textContent = label;
  const y = currentMonth.getFullYear();
  const m = String(currentMonth.getMonth() + 1).padStart(2, '0');
  document.getElementById('monthPicker').value = `${y}-${m}`;
}

function changeMonth(d) {
  currentMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + d, 1);
  updateMonthDisplay(); renderMonth();
}

function goToToday() { currentMonth = new Date(); updateMonthDisplay(); renderMonth(); }

function onMonthPick() {
  const v = document.getElementById('monthPicker').value;
  if (!v) return;
  const [y, m] = v.split('-');
  currentMonth = new Date(parseInt(y), parseInt(m) - 1, 1);
  updateMonthDisplay(); renderMonth();
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// ADD / DELETE
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateSuggestions() {
  const dl = document.getElementById('medSuggestions');
  if (!dl) return;
  const unique = [...new Set(meds.map(m => m.name))].sort((a, b) => a.localeCompare(b, 'fr'));
  dl.innerHTML = unique.map(n => `<option value="${n.replace(/"/g,'&quot;')}">`).join('');
}


  // Recherche un m√©dicament avec nom similaire (insensible √† la casse) + m√™me date + m√™me lieu
  return meds.find(m =>
    m.lieu === lieu &&
    m.date === date &&
    m.name.toLowerCase().trim() === name.toLowerCase().trim()
  );
}

function addMed() {
  const name = document.getElementById('medName').value.trim();
  const date = document.getElementById('medDate').value;
  const lieu = document.getElementById('medLieu').value;
  if (!name || !date) { toast('Remplissez le nom et la date.', 'error'); return; }

  const duplicate = checkDuplicate(name, date, lieu);
  if (duplicate) {
    const dateStr = new Date(date + 'T00:00:00').toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
    if (!confirm(`"${duplicate.name}" avec la m√™me p√©remption (${dateStr}) existe d√©j√† en ${LIEU_LABELS[lieu]}.\n\nS'agit-il du m√™me m√©dicament ?`)) {
      // L'utilisateur dit non ‚Üí on ajoute quand m√™me
    } else {
      // L'utilisateur dit oui ‚Üí on n'ajoute pas
      toast(`‚ö†Ô∏è Doublon ignor√© ‚Äî ${name} d√©j√† pr√©sent`, 'error');
      return;
    }
  }

  meds.push({ id: Date.now().toString(), name, date, lieu });
  save();
  document.getElementById('medName').value = '';
  document.getElementById('medDate').value = '';
  document.getElementById('transcript').textContent = 'Appuyez sur üé§ et dites par exemple : "Doliprane 1000 p√©remption mars 2026"';
  document.getElementById('transcript').classList.remove('active');
  toast(`‚úì ${name} ajout√© en ${LIEU_LABELS[lieu]}`);
  if (currentTab === 'stock') renderStock(); else renderMonth();
}

function deleteMed(id) {
  const med = meds.find(m => m.id === id);
  if (!med) return;
  if (!confirm(`Supprimer "${med.name}" ?`)) return;
  meds = meds.filter(m => m.id !== id);
  save();
  toast(`üóë ${med.name} supprim√©`);
  if (currentTab === 'stock') renderStock(); else renderMonth();
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// TRANSFERT
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// EXPORT PDF
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function exportPDF() {
  const label = currentMonth.toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
  const lieu  = lieuFilterMonth !== 'all' ? ` ‚Äî ${LIEU_LABELS[lieuFilterMonth]}` : '';
  document.getElementById('printSubtitle').textContent =
    `M√©dicaments p√©rimant en ${label}${lieu} ‚Äî Imprim√© le ${new Date().toLocaleDateString('fr-FR')}`;
  setTimeout(() => window.print(), 100);
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// UTILS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function esc(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// DICT√âE VOCALE
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let recognition = null, recording = false, chainMode = false;

// Mots-cl√©s qui d√©clenchent l'enregistrement automatique
const SAVE_KEYWORDS = ['suivant', 'valider', 'enregistrer', 'ok', 'sauvegarder', 'ajouter'];

function setChainMode(active) {
  chainMode = active;
  const btn  = document.getElementById('chainBtn');
  const hint = document.getElementById('voiceHint');
  btn.classList.toggle('chain-active', active);
  if (active) {
    hint.innerHTML = 'üîó Mode cha√Æne actif ‚Äî dites <strong>"Doliprane f√©vrier 2026 suivant"</strong> pour enregistrer et continuer automatiquement';
  } else {
    hint.innerHTML = 'üí° Dites : "Doliprane 500 p√©remption janvier 2027" ‚Äî ou activez le <strong>mode cha√Æne</strong> pour encha√Æner';
  }
}

function startListening() {
  if (!recognition) return;
  try {
    recognition.start();
    recording = true;
    document.getElementById('voiceBtn').textContent = '‚èπ';
    document.getElementById('voiceBtn').classList.add('recording');
    document.getElementById('transcript').textContent = chainMode ? 'üîó En √©coute ‚Äî dites le m√©dicament puis "suivant"‚Ä¶' : 'En √©coute‚Ä¶';
    document.getElementById('transcript').classList.add('active');
  } catch(e) { toast('Impossible de d√©marrer le microphone.', 'error'); }
}

function stopListening() {
  if (recognition) recognition.stop();
}

function initVoice() {
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SR) {
    document.getElementById('voiceBtn').disabled = true;
    document.getElementById('chainBtn').disabled = true;
    document.getElementById('voiceUnsupportedMsg').style.display = 'block';
    document.getElementById('voiceHint').style.display = 'none';
    document.getElementById('transcript').style.display = 'none';
    return;
  }
  try {
    recognition = new SR();
    recognition.lang = 'fr-FR';
    recognition.continuous = false;
    recognition.interimResults = true;

    recognition.onresult = (e) => {
      let interim = '', final = '';
      for (let i = e.resultIndex; i < e.results.length; i++) {
        const t = e.results[i][0].transcript;
        if (e.results[i].isFinal) final += t; else interim += t;
      }
      const text = final || interim;
      document.getElementById('transcript').textContent = text;
      document.getElementById('transcript').classList.add('active');
      if (final) parseVoice(final);
    };

    recognition.onend = () => {
      recording = false;
      document.getElementById('voiceBtn').textContent = 'üé§';
      document.getElementById('voiceBtn').classList.remove('recording');
      // En mode cha√Æne, on red√©marre automatiquement si toujours actif
      if (chainMode) {
        setTimeout(() => { if (chainMode) startListening(); }, 400);
      }
    };

    recognition.onerror = (ev) => {
      recording = false;
      document.getElementById('voiceBtn').textContent = 'üé§';
      document.getElementById('voiceBtn').classList.remove('recording');
      if (ev.error === 'no-speech' && chainMode) {
        // En mode cha√Æne, on ignore "no-speech" et on relance
        setTimeout(() => { if (chainMode) startListening(); }, 600);
        return;
      }
      const msgs = { 'not-allowed': 'Acc√®s micro refus√©.', 'no-speech': 'Aucune parole d√©tect√©e.' };
      toast(msgs[ev.error] || 'Erreur microphone', 'error');
      if (chainMode) setChainMode(false);
    };

    // Bouton micro
    document.getElementById('voiceBtn').addEventListener('click', () => {
      if (recording) {
        if (chainMode) { setChainMode(false); stopListening(); }
        else { stopListening(); }
        return;
      }
      startListening();
    });

    // Bouton mode cha√Æne
    document.getElementById('chainBtn').addEventListener('click', () => {
      if (chainMode) {
        setChainMode(false);
        stopListening();
      } else {
        setChainMode(true);
        startListening();
      }
    });

  } catch(e) {
    document.getElementById('voiceBtn').disabled = true;
    document.getElementById('chainBtn').disabled = true;
    document.getElementById('voiceUnsupportedMsg').style.display = 'block';
  }
}

initVoice();

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// PARSING VOIX
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const MONTHS_FR = {
  janvier:1, f√©vrier:2, fevrier:2, mars:3, avril:4, mai:5, juin:6,
  juillet:7, ao√ªt:8, aout:8, septembre:9, octobre:10, novembre:11, d√©cembre:12, decembre:12
};

function parseVoice(text) {
  const t = text.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");

  // ‚îÄ‚îÄ D√©tection mot-cl√© de validation ‚îÄ‚îÄ
  let autoSave = false;
  let cleanText = text;
  for (const kw of SAVE_KEYWORDS) {
    const re = new RegExp('\\s*' + kw + '\\s*$', 'i');
    if (re.test(t)) {
      autoSave = true;
      cleanText = text.replace(new RegExp('\\s*' + kw + '\\s*$', 'i'), '').trim();
      break;
    }
  }

  const tClean = cleanText.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");

  let year = null, month = null, day = 1;
  let dateStartIndex = -1;

  const separators = ['date de peremption','peremption','expire le','expire en','expire','perime le','perime en','perime','jusqu au'];
  let sepIndex = -1;
  for (const sep of separators) {
    const idx = tClean.indexOf(sep);
    if (idx > 1) { sepIndex = idx; break; }
  }

  const reMonthYear = /(\d{1,2}\s+)?(janvier|fevrier|mars|avril|mai|juin|juillet|aout|septembre|octobre|novembre|decembre)\s+(\d{4})/;
  const reSlash = /(\d{1,2})[\/\-](\d{4})/;

  const searchZone = sepIndex >= 0 ? tClean.slice(sepIndex) : tClean;
  const searchZoneOffset = sepIndex >= 0 ? sepIndex : 0;

  const m1 = searchZone.match(reMonthYear);
  if (m1) {
    month = MONTHS_FR[m1[2]]; year = parseInt(m1[3]);
    day   = m1[1] ? parseInt(m1[1]) : new Date(year, month, 0).getDate();
    dateStartIndex = searchZoneOffset + searchZone.indexOf(m1[0]);
  }

  if (!month) {
    const m2 = searchZone.match(reSlash);
    if (m2) {
      month = parseInt(m2[1]); year = parseInt(m2[2]);
      day   = new Date(year, month, 0).getDate();
      dateStartIndex = searchZoneOffset + searchZone.indexOf(m2[0]);
    }
  }

  let cutAt = sepIndex >= 0 ? sepIndex : (dateStartIndex >= 0 ? dateStartIndex : -1);
  let name = cutAt > 0 ? cleanText.slice(0, cutAt) : cleanText;
  name = name.replace(/\s+(le|la|les|du|de|en|au|pour|avec|et)\s*$/i, '').replace(/[,;:\-]+$/, '').replace(/\s+/g, ' ').trim();
  if (name) name = name.charAt(0).toUpperCase() + name.slice(1);

  if (name) document.getElementById('medName').value = name;

  if (year && month) {
    document.getElementById('medDate').value = `${year}-${String(month).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
    if (!autoSave) toast(`üé§ "${name}" ‚Äî ${String(month).padStart(2,'0')}/${year}`);
  } else if (name && !autoSave) {
    toast(`üé§ Nom : "${name}" ‚Äî V√©rifiez la date`);
  }

  // ‚îÄ‚îÄ Auto-save si mot-cl√© d√©tect√© ‚îÄ‚îÄ
  if (autoSave && name && year && month) {
    // Petit d√©lai pour que l'UI se mette √† jour avant l'enregistrement
    setTimeout(() => {
      addMedSilent(name, `${year}-${String(month).padStart(2,'0')}-${String(day).padStart(2,'0')}`);
    }, 200);
  }
}

function addMedSilent(name, date) {
  const lieu = document.getElementById('medLieu').value;

  const duplicate = checkDuplicate(name, date, lieu);
  if (duplicate) {
    const dateStr = new Date(date + 'T00:00:00').toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
    if (confirm(`"${duplicate.name}" (${dateStr}) existe d√©j√† en ${LIEU_LABELS[lieu]}.\n\nS'agit-il du m√™me m√©dicament ?`)) {
      document.getElementById('transcript').textContent = `‚ö†Ô∏è Doublon ignor√© ‚Äî en √©coute pour le suivant‚Ä¶`;
      document.getElementById('medName').value = '';
      document.getElementById('medDate').value = '';
      toast(`‚ö†Ô∏è Doublon ignor√© ‚Äî ${name}`, 'error');
      return;
    }
  }

  meds.push({ id: Date.now().toString(), name, date, lieu });
  save();
  document.getElementById('transcript').textContent = `‚úì "${name}" enregistr√© ‚Äî en √©coute pour le suivant‚Ä¶`;
  document.getElementById('medName').value = '';
  document.getElementById('medDate').value = '';
  toast(`‚úì ${name} ajout√© !`);
  if (currentTab === 'stock') renderStock(); else renderMonth();
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// D√âTECTION DOUBLONS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function detectDuplicates() {
  // Groupe par lieu + nom (insensible casse) + date
  const groups = {};
  meds.forEach(m => {
    const key = `${m.lieu}||${m.name.toLowerCase().trim()}||${m.date}`;
    if (!groups[key]) groups[key] = [];
    groups[key].push(m);
  });

  const dupes = Object.values(groups).filter(g => g.length > 1);

  const overlay = document.getElementById('dupesOverlay');
  const info    = document.getElementById('dupesInfo');
  const list    = document.getElementById('dupesList');

  if (dupes.length === 0) {
    toast('‚úÖ Aucun doublon trouv√© dans ton stock !');
    return;
  }

  info.textContent = `${dupes.length} groupe${dupes.length > 1 ? 's' : ''} de doublons trouv√©${dupes.length > 1 ? 's' : ''} dans le m√™me lieu.`;

  list.innerHTML = dupes.map(group => {
    const date = new Date(group[0].date + 'T00:00:00').toLocaleDateString('fr-FR', { day:'2-digit', month:'long', year:'numeric' });
    const items = group.map(m => `
      <div class="dupe-item">
        <span>${m.name}</span>
        <span class="dupe-lieu">${LIEU_LABELS[m.lieu]}</span>
        <span class="dupe-date">Exp. ${date}</span>
        <button class="med-del" onclick="deleteMedFromDupes('${m.id}')"
          style="width:26px;height:26px;border-radius:6px;border:1.5px solid var(--border);background:transparent;cursor:pointer;color:var(--muted);font-size:0.85rem;display:flex;align-items:center;justify-content:center;flex-shrink:0;">‚úï</button>
      </div>`).join('');
    return `
      <div class="dupe-group">
        <div class="dupe-group-title">‚ö†Ô∏è ${group[0].name} ‚Äî ${group.length} entr√©es</div>
        ${items}
      </div>`;
  }).join('');

  overlay.classList.add('open');
}

function deleteMedFromDupes(id) {
  const med = meds.find(m => m.id === id);
  if (!med) return;
  if (!confirm(`Supprimer "${med.name}" ?`)) return;
  meds = meds.filter(m => m.id !== id);
  save();
  toast(`üóë ${med.name} supprim√©`);
  // Rafra√Æchit la liste des doublons
  detectDuplicates();
  // Si plus de doublons, ferme le modal
  const groups = {};
  meds.forEach(m => {
    const key = `${m.lieu}||${m.name.toLowerCase().trim()}||${m.date}`;
    if (!groups[key]) groups[key] = [];
    groups[key].push(m);
  });
  if (!Object.values(groups).some(g => g.length > 1)) closeDupesModal();
  if (currentTab === 'stock') renderStock(); else renderMonth();
}

function closeDupesModal() {
  document.getElementById('dupesOverlay').classList.remove('open');
}


function exportJSON() {
  const data = JSON.stringify(meds, null, 2);
  const b64  = btoa(unescape(encodeURIComponent(data)));
  const a    = document.createElement('a');
  a.href     = 'data:application/json;charset=utf-8;base64,' + b64;
  a.download = `pharmacie-backup-${new Date().toISOString().slice(0,10)}.json`;
  a.click();
  toast(`‚úì Sauvegarde export√©e (${meds.length} m√©dicament${meds.length > 1 ? 's' : ''})`);
}

function importJSON(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = (e) => {
    try {
      const imported = JSON.parse(e.target.result);
      if (!Array.isArray(imported)) throw new Error('Format invalide');
      // Fusionne sans doublons (bas√© sur l'id)
      const existingIds = new Set(meds.map(m => m.id));
      const newMeds = imported.filter(m => !existingIds.has(m.id));
      meds = [...meds, ...newMeds];
      save();
      renderStock();
      toast(`‚úì ${newMeds.length} m√©dicament${newMeds.length > 1 ? 's' : ''} import√©${newMeds.length > 1 ? 's' : ''} (${imported.length - newMeds.length} d√©j√† pr√©sent${imported.length - newMeds.length > 1 ? 's' : ''})`);
    } catch(err) {
      toast('‚ö†Ô∏è Fichier invalide ‚Äî utilisez un export PharmExpiry', 'error');
    }
    // Reset l'input pour permettre de r√©importer le m√™me fichier
    event.target.value = '';
  };
  reader.readAsText(file);
}





if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/P-remptions-/service-worker.js')
      .catch(err => console.log('SW non enregistr√© :', err));
  });
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// INIT
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
updateMonthDisplay();
renderStock();
</script>
</body>
</html>
